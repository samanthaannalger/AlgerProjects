se = sd / sqrt(n))
colors <- c("dodgerblue4", "dodgerblue4", "dodgerblue4")
plot1 <- ggplot(VirusSum, aes(x=target_name, y=mean, fill=target_name)) +
geom_bar(stat="identity",
position=position_dodge()) + labs(x="Virus", y = "% Prevalence")
plot1 + theme_minimal(base_size = 17) + theme(legend.position=c(3, 3)) + coord_cartesian(ylim = c(0, 1)) + scale_fill_manual(values=colors) + scale_y_continuous(labels = scales::percent)
VirusModel <- ddply(BombSurv, c("target_name", "site"), summarise,
n = length(norm_genome_copbee),
mean = mean(norm_genome_copbee),
sd = sd(norm_genome_copbee),
se = sd / sqrt(n))
BombSurv$norm_genome_copbee[BombSurv$norm_genome_copbee == 0] <- NA
VirusModelNA <- ddply(BombSurv, c("target_name", "site"), summarise,
n = length(norm_genome_copbee),
mean = mean(norm_genome_copbee, na.rm=TRUE),
sd = sd(norm_genome_copbee, na.rm=TRUE),
se = sd / sqrt(n))
VirusModelNA <- dplyr::select(VirusModelNA, target_name, site, mean)
VirusModelNA <- rename(VirusModelNA, c("mean"="BombMeanNA"))
VirusModelNA$BombMeanNA[VirusModelNA$BombMeanNA == "NaN"] <- 0
VirusModelHB <- ddply(BombSurv, c("target_name", "site"), summarise,
n = length(norm_genome_copbeeHB),
mean = mean(norm_genome_copbeeHB),
sd = sd(norm_genome_copbeeHB),
se = sd / sqrt(n))
VirusBombPrev <- ddply(BombSurv, c("target_name", "site"), summarise,
n = length(virusBINY),
mean = mean(virusBINY),
sd = sd(virusBINY),
se = sd / sqrt(n))
VirusBombPrev <- dplyr::select(VirusBombPrev, target_name, site, mean)
VirusBombPrev <- rename(VirusBombPrev, c("mean"="BombPrev"))
library(dplyr)
xx <- dplyr::select(BombSurv, site, apiary_near_far, target_name, ShannonDIV, Density, sumApiaries, sumColonies)
xx <- unique(xx)
VirusModelHB <- dplyr::select(VirusModelHB, target_name, site, mean)
viralLoadDF <- merge(VirusModelHB, VirusModel, by=c("target_name","site"))
viralLoadDF <- rename(viralLoadDF, c("mean.x"="HBviralLoad", "mean.y"="BombusViralLoad"))
viralLoadDF <- merge(viralLoadDF, xx, by=c("target_name","site"))
viralLoadDF <- merge(viralLoadDF, VirusBombPrev, by=c("target_name","site"))
viralLoadDF <- merge(viralLoadDF, VirusModelNA, by=c("target_name","site"))
viralLoadDF <- viralLoadDF[!viralLoadDF$target_name==("IAPV"),]
viralLoadDF$HBviralLoad[is.na(viralLoadDF$HBviralLoad)] <- 0
x <- split(viralLoadDF, viralLoadDF$target_name)
plot(x=log10(x$DWV$HBviralLoad), y=log10(x$DWV$BombusViralLoad))
modDWV <- lm(log10(x$DWV$BombusViralLoad+1)~log10(x$DWV$HBviralLoad+1))
summary(modDWV)
plot(x=log10(x$BQCV$HBviralLoad), y=log10(x$BQCV$BombusViralLoad))
modBQCV <- lm(log10(x$BQCV$BombusViralLoad+1)~log10(x$BQCV$HBviralLoad+1))
summary(modBQCV)
plot(x=x$DWV$BombPrev, y=log10(x$DWV$BombMeanNA))
modDWV1 <- lm(log10(x$DWV$BombMeanNA+1)~x$DWV$BombPrev)
summary(modDWV1)
cbind(x$DWV$site, x$DWV$apiary_near_far, x$DWV$HBviralLoad, x$DWV$BombusViralLoad)
print(viralLoadDF)
write.csv(viralLoadDF, file="MixedModelDF.csv")
viralLoadDF$apiary_near_far <- as.factor(viralLoadDF$apiary_near_far)
library(lme4)
library(MASS)
mod <- glmmPQL(data=x$DWV, fixed = BombMeanNA~apiary_near_far + sumApiaries, random = ~ 1 | site, family = gaussian)
summary(mod)
mod1 <- glmmPQL(data=x$BQCV, fixed = BombMeanNA~apiary_near_far + sumApiaries, random = ~ 1 | site, family = gaussian)
summary(mod1)
mod3 <- glmmPQL(data=x$BQCV, fixed = BombPrev~apiary_near_far + sumApiaries, random = ~ 1 | site, family = gaussian)
summary(mod3)
mod4 <- glmmPQL(data=x$DWV, fixed = BombPrev~apiary_near_far + sumApiaries, random = ~ 1 | site, family = gaussian)
summary(mod4)
mod5 <- glmmPQL(data=viralLoadDF, fixed = BombMeanNA~(apiary_near_far + sumApiaries) * target_name, random = ~ 1 | site, family = gaussian)
summary(mod5)
mod <- glmmPQL(data=x$DWV, fixed = BombMeanNA~apiary_near_far + sumApiaries, random = ~ 1 | site, family = gaussian)
summary(mod)
mod1 <- glmmPQL(data=x$BQCV, fixed = BombMeanNA~apiary_near_far + sumApiaries, random = ~ 1 | site, family = gaussian)
summary(mod1)
mod3 <- glmmPQL(data=x$BQCV, fixed = BombPrev~apiary_near_far + sumApiaries, random = ~ 1 | site, family = gaussian)
summary(mod3)
mod3 <- glmmPQL(data=x$BQCV, fixed = BombPrev~apiary_near_far + sumApiaries, random = ~ 1 | site, family = gaussian)
summary(mod3)
mod4 <- glmmPQL(data=x$DWV, fixed = BombPrev~apiary_near_far + sumApiaries, random = ~ 1 | site, family = gaussian)
summary(mod4)
mod3 <- glmmPQL(data=x$BQCV, fixed = BombPrev~apiary_near_far + sumApiaries, random = ~ 1 | site, family = gaussian)
summary(mod3)
mod3 <- glmmPQL(data=x$BQCV, fixed = BombPrev~apiary_near_far, random = ~ 1 | site, family = gaussian)
summary(mod3)
mod3 <- glmmPQL(data=x$BQCV, fixed = BombPrev~apiary_near_far*Species, random = ~ 1 | site, family = gaussian)
mod3 <- glmmPQL(data=x$BQCV, fixed = BombPrev~apiary_near_far * species, random = ~ 1 | site, family = gaussian)
head(x$BQCV)
head(BombSurv)
DFsplit <- split(BombSurv, BombSurv$target_name)
DFsplit$BQCV$HBSiteBin
mod3 <- glmmPQL(data=x$BQCV, fixed = BombPrev~apiary_near_far, random = ~ 1 | site, family = family = binomial (link = "logit"))
mod3 <- glmmPQL(data=x$BQCV, fixed = BombPrev~apiary_near_far, random = ~ 1 | site, family = binomial (link = "logit"))
mod3
summary(mod3)
mod3 <- glmmPQL(data=x$BQCV, fixed = BombPrev~apiary_near_far, random = ~ 1 | site, family = binomial (link = "logit"))
summary(mod3)
x$BQCV$apiary_near_far
str(x$BQCV)
x$BQCV$apiary_near_far <- as.factor(x$BQCV$apiary_near_far)
str(x$BQCV)
mod3 <- glmmPQL(data=x$BQCV, fixed = BombPrev~apiary_near_far, random = ~ 1 | site, family = binomial (link = "logit"))
summary(mod3)
mod3 <- glmmPQL(data=x$BQCV, fixed = BombPrev~apiary_near_far + sumApiaries, random = ~ 1 | site, family = binomial (link = "logit"))
summary(mod3)
mod <- glmmPQL(data=x$DWV, fixed = BombMeanNA~apiary_near_far + sumApiaries, random = ~ 1 | site, family = gaussian)
summary(mod)
mod1 <- glmmPQL(data=x$BQCV, fixed = BombMeanNA~apiary_near_far + sumApiaries, random = ~ 1 | site, family = gaussian)
summary(mod1)
mod3 <- glmmPQL(data=x$BQCV, fixed = BombPrev~apiary_near_far + sumApiaries, random = ~ 1 | site, family = binomial (link = "logit"))
summary(mod3)
mod <- glmmPQL(data=x$DWV, fixed = BombMeanNA~apiary_near_far, random = ~ 1 | site, family = gaussian)
summary(mod)
viralLoadDF
DFsplit$BQCV
head(DFsplit$BQCV)
mod5 <- glmmPQL(data=DFsplit$BQCV, fixed = virusBINY~apiary_near_far, random = ~ 1 | site, family = binomial (link = "logit"))
summary(mod5)
mod5 <- glmmPQL(data=BombSurv, fixed = virusBINY~apiary_near_far*target_name, random = ~ 1 | site, family = binomial (link = "logit"))
summary(mod5)
BombSurv$target_name
mod6 <- glmmPQL(data=BombSurv, fixed = norm_genome_copbee~apiary_near_far+target_name, random = ~ 1 | site, family = binomial (link = "logit"))
mod6 <- glmmPQL(data=DFsplit$DWV, fixed = norm_genome_copbee~apiary_near_far, random = ~ 1 | site, family = gaussian())
summary(mod6)
mod6 <- glmmPQL(data=DFsplit$DWV, fixed = log(norm_genome_copbee)~apiary_near_far, random = ~ 1 | site, family = gaussian())
summary(mod6)
mod6 <- glmmPQL(data=DFsplit$DWV, fixed = norm_genome_copbee~apiary_near_far, random = ~ 1 |site + species, family = gaussian())
summary(mod6)
library(lme4)
lmermod <- lmer(data=data=x$DWV, formula = BombPrev~apiary_near_far + (apiary_near_far | site))
lmermod <- lmer(data=x$DWV, formula = BombPrev~apiary_near_far + (apiary_near_far | site))
lmermod <- lmer(data=x$DWV, formula = BombPrev~apiary_near_far + | site)
lmermod <- lmer(data=x$DWV, formula = BombPrev~apiary_near_far + (apiary_near_far | site))
lmermod <- lmer(data=DFsplit$DWV, formula = BombPrev~apiary_near_far + (apiary_near_far | site))
lmermod <- lmer(data=DFsplit$DWV, formula = VirusBINY~apiary_near_far + (apiary_near_far | site))
lmermod <- lmer(data=DFsplit$DWV, formula = virusBINY~apiary_near_far + (apiary_near_far | site))
summary(lmermod)
lmermod
aov(lmermod)
anova(mermod)
anova(lmermod)
x<-anova(lmermod)
summary(x)
x<-anova(lmermod)
summary(x)
x<-aov(lmermod)
summary(x)
lmermod <- glmer(data=DFsplit$DWV, formula = virusBINY~apiary_near_far + (apiary_near_far | site))
lmermod <- glmer(data=DFsplit$BQCV, formula = virusBINY~apiary_near_far + (apiary_near_far | site), family=binomial(link = "logit"))
lmermod
summary(lmermod)
lmermod <- glmer(data=DFsplit$BQCV, formula = virusBINY~apiary_near_far + (1 | site), family=binomial(link = "logit"))
summary(lmermod)
DFsplit$BQCV$virusBINY
lmermod <- glmer(data=DFsplit$BQCV, formula = virusBINY~apiary_near_far + (1|site), family=binomial(link = "logit"))
lmermod <- glmer(data=DFsplit$BQCV, formula = norm_genome_copbee~apiary_near_far + (1|site), family=binomial(link = "logit"))
lmermod1 <- glmer(data=DFsplit$BQCV, formula = norm_genome_copbee~apiary_near_far + (1|site), family=gaussian)
summary(lmermod1)
lmermod1 <- lmer(data=DFsplit$BQCV, formula = norm_genome_copbee~apiary_near_far + (1|site))
summary(lmermod1)
lmermod1 <- lmer(data=DFsplit$DWV, formula = norm_genome_copbee ~ apiary_near_far + (1|site))
summary(lmermod1)
lmermod1.null <- lmer(data=DFsplit$DWV, formula = norm_genome_copbee ~ 1 + (1|site), REML = FALSE)
lmermod1 <- lmer(data=DFsplit$DWV, formula = norm_genome_copbee ~ apiary_near_far + (1|site), REML = FALSE)
anova(lmermod1.null,lmermod1)
lmermod1.null <- lmer(data=DFsplit$DWV, formula = norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
lmermod1 <- lmer(data=DFsplit$DWV, formula = norm_genome_copbee ~ apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(lmermod1.null,lmermod1)
DFsplit$DWV
head(DFsplit$DWV)
lmermod1.null <- lmer(data=DFsplit$DWV, formula = norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
lmermod1 <- lmer(data=DFsplit$DWV, formula = norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(lmermod1.null,lmermod1)
lmermod1.null <- lmer(data=DFsplit$DWV, formula = norm_genome_copbee ~ apiary_near_far + (1|site) + (1|species), REML = FALSE)
lmermod1 <- lmer(data=DFsplit$DWV, formula = norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(lmermod1.null,lmermod1)
lmermod <- glmer(data=DFsplit$BQCV, formula = virusBINY~apiary_near_far + (1|site) + (1|species), family=binomial(link = "logit"))
summary(lmermod)
statsplit <- split(BombSurv, BombSurv$target_name)
chisq.test(statsplit$BQCV$virusBINY, statsplit$BQCV$species)
fisher.test(statsplit$BQCV$virusBINY, statsplit$BQCV$species)
chisq.test(statsplit$DWV$virusBINY, statsplit$DWV$species)
library(lme4)
lmermod <- glmer(data=DFsplit$BQCV, formula = virusBINY~apiary_near_far + (1|site) + (1|species), family=binomial(link = "logit"))
summary(lmermod)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY~apiary_near_far + (1|site) + (1|species), family=binomial(link = "logit"))
summary(BQCVmod)
DWVmod <- glmer(data=DFsplit$DWV, formula = virusBINY~apiary_near_far + (1|site) + (1|species), family=binomial(link = "logit"))
summary(DWVmod)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY~apiary_near_far + (1|site) + (1|species), family=binomial(link = "logit"), REML = TRUE)
DWVpos <- subset(DFsplit$DWV, virusBINY==1)
DWVpos
DWVpos$X
DWVpos$virusBINY
hist(DWVpos$norm_genome_copbee)
hist(DWVpos$norm_genome_copbee, breaks=c(1:10))
hist(DWVpos$norm_genome_copbee, breaks=c(1,10))
DWVpos$log10norm_genome_copbee <- log10(DWVpos$norm_genome_copbee)
DWVpos$log10norm_genome_copbee
DWVpos$norm_genome_copbee
hist(DWVpos$log10norm_genome_copbee)
lmermod1.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
lmermod1 <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(lmermod1.null,lmermod1)
lmermod1.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ apiary_near_far + (1|site) + (1|species), REML = FALSE)
lmermod1 <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(lmermod1.null,lmermod1)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY~apiary_near_far + sumApiaries + (1|site) + (1|species), family=binomial(link = "logit"))
summary(BQCVmod)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY~sumApiaries + (1|site) + (1|species), family=binomial(link = "logit"))
summary(BQCVmod)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY~apiary_near_far + (1|site) + (1|species), family=binomial(link = "logit"))
summary(BQCVmod)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY~apiary_near_far + sumApiaries + (1|site) + (1|species), family=binomial(link = "logit"))
summary(BQCVmod)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY~ sumApiaries + (1|site) + (1|species), family=binomial(link = "logit"))
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY~ sumApiaries + (1|site) + (1|species), family=binomial(link = "logit"))
summary(BQCVmod)
DFsplot
DFsplit
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY~ sumApiaries + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(BQCVmod)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY~ apiary_near_far + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(BQCVmod)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY~ apiary_near_far + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(BQCVmod)
plot(sumApiaries, virusBINY)
plot(DFsplit$BQCV$sumApiaries, DFsplit$BQCV$virusBINY)
DFsplit$BQCV$sumApiaries
summary(DFsplit$BQCV$sumApiaries)
table(DFsplit$BQCV$sumApiaries)
barplot(DFsplit$BQCV$sumApiaries, DFsplit$BQCV$virusBINY)
plot <- ggplot(DFsplit$BQCV, aes(x=sumApiaries, y=virusBINY, fill=colors))+
geom_bar(stat="identity") + labs(x=NULL, y = "% Prevalence")
plot
plot <- ggplot(DFsplit$BQCV, aes(x=DFsplit$BQCV$sumApiaries, y=DFsplit$BQCV$virusBINY, fill=colors))+
geom_bar(stat="identity") + labs(x=NULL, y = "% Prevalence")
plot
DWVmod <- glmer(data=DFsplit$DWV, formula = virusBINY~sumApiaries + (1|site) + (1|species), family=binomial(link = "logit"))
summary(DWVmod)
DWVmod <- glmer(data=DFsplit$DWV, formula = virusBINY~apiary_near_far + (1|site) + (1|species), family=binomial(link = "logit"))
summary(DWVmod)
DWVpos <- subset(DFsplit$DWV, virusBINY==1)
DWVpos$log10norm_genome_copbee <- log10(DWVpos$norm_genome_copbee)
lmermod1.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ apiary_near_far + (1|site) + (1|species), REML = FALSE)
lmermod1 <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(lmermod1.null,lmermod1)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY~ sumApiaries + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY~ sumApiaries + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(BQCVmod)
SpacDat <- read.table("2015SurveySpatial.csv",header=TRUE,sep=",",stringsAsFactors=FALSE)
head(SpacDat)
SpacDat[,c("site", "lat", "long")]
SpacDat <- SpacDat[,c("site", "lat", "long")]
SpacDat
BombSurv <- merge(BombSurv, SpacDat, by="site")
BombSurv
BombSurv$lat.y
DFsplit <- split(BombSurv, BombSurv$target_name)
DFsplit
ls()
rm(list=ls())
library(RColorBrewer)
library(ggplot2)
library(dplyr)
library(plyr)
setwd("~/AlgerProjects/2015_Bombus_Survey/CSV_Files")
BombSurv <- read.table("BombSurvNHBS.csv",header=TRUE,sep=",",stringsAsFactors=FALSE)
BombSurv <- dplyr::select(BombSurv, -City, -Name, -virusBINY_PreFilter)
BombSurv<-BombSurv[!BombSurv$site==("PITH"),]
BombSurv<-BombSurv[!BombSurv$site==("STOW"),]
BombSurv<-BombSurv[!BombSurv$species==("Griseocollis"),]
BombSurv<-BombSurv[!BombSurv$species==("Sandersonii"),]
VirusModel <- ddply(BombSurv, c("target_name", "site"), summarise,
n = length(norm_genome_copbee),
mean = mean(norm_genome_copbee),
sd = sd(norm_genome_copbee),
se = sd / sqrt(n))
BombSurv$norm_genome_copbee[BombSurv$norm_genome_copbee == 0] <- NA
VirusModelNA <- ddply(BombSurv, c("target_name", "site"), summarise,
n = length(norm_genome_copbee),
mean = mean(norm_genome_copbee, na.rm=TRUE),
sd = sd(norm_genome_copbee, na.rm=TRUE),
se = sd / sqrt(n))
VirusModelNA <- dplyr::select(VirusModelNA, target_name, site, mean)
VirusModelNA <- rename(VirusModelNA, c("mean"="BombMeanNA"))
VirusModelNA$BombMeanNA[VirusModelNA$BombMeanNA == "NaN"] <- 0
VirusModelHB <- ddply(BombSurv, c("target_name", "site"), summarise,
n = length(norm_genome_copbeeHB),
mean = mean(norm_genome_copbeeHB),
sd = sd(norm_genome_copbeeHB),
se = sd / sqrt(n))
VirusBombPrev <- ddply(BombSurv, c("target_name", "site"), summarise,
n = length(virusBINY),
mean = mean(virusBINY),
sd = sd(virusBINY),
se = sd / sqrt(n))
VirusBombPrev <- dplyr::select(VirusBombPrev, target_name, site, mean)
VirusBombPrev <- rename(VirusBombPrev, c("mean"="BombPrev"))
library(dplyr)
xx <- dplyr::select(BombSurv, site, apiary_near_far, target_name, ShannonDIV, Density, sumApiaries, sumColonies)
xx <- unique(xx)
VirusModelHB <- dplyr::select(VirusModelHB, target_name, site, mean)
viralLoadDF <- merge(VirusModelHB, VirusModel, by=c("target_name","site"))
viralLoadDF <- rename(viralLoadDF, c("mean.x"="HBviralLoad", "mean.y"="BombusViralLoad"))
viralLoadDF <- merge(viralLoadDF, xx, by=c("target_name","site"))
viralLoadDF <- merge(viralLoadDF, VirusBombPrev, by=c("target_name","site"))
viralLoadDF <- merge(viralLoadDF, VirusModelNA, by=c("target_name","site"))
viralLoadDF <- viralLoadDF[!viralLoadDF$target_name==("IAPV"),]
viralLoadDF$HBviralLoad[is.na(viralLoadDF$HBviralLoad)] <- 0
x <- split(viralLoadDF, viralLoadDF$target_name)
plot(x=log10(x$DWV$HBviralLoad), y=log10(x$DWV$BombusViralLoad))
modDWV <- lm(log10(x$DWV$BombusViralLoad+1)~log10(x$DWV$HBviralLoad+1))
summary(modDWV)
plot(x=log10(x$BQCV$HBviralLoad), y=log10(x$BQCV$BombusViralLoad))
modBQCV <- lm(log10(x$BQCV$BombusViralLoad+1)~log10(x$BQCV$HBviralLoad+1))
summary(modBQCV)
plot(x=x$DWV$BombPrev, y=log10(x$DWV$BombMeanNA))
modDWV1 <- lm(log10(x$DWV$BombMeanNA+1)~x$DWV$BombPrev)
summary(modDWV1)
cbind(x$DWV$site, x$DWV$apiary_near_far, x$DWV$HBviralLoad, x$DWV$BombusViralLoad)
print(viralLoadDF)
viralLoadDF$apiary_near_far <- as.factor(viralLoadDF$apiary_near_far)
library(lme4)
library(MASS)
mod <- glmmPQL(data=x$DWV, fixed = BombMeanNA~apiary_near_far+sumApiary, random = ~ 1 | site, family = gaussian)
summary(mod)
mod1 <- glmmPQL(data=x$BQCV, fixed = BombMeanNA~apiary_near_far + sumApiaries, random = ~ 1 | site, family = gaussian)
summary(mod1)
x$BQCV$apiary_near_far <- as.factor(x$BQCV$apiary_near_far)
mod3 <- glmmPQL(data=x$BQCV, fixed = BombPrev~apiary_near_far, random = ~ 1 | site, family = binomial (link = "logit"))
summary(mod3)
DFsplit <- split(BombSurv, BombSurv$target_name)
DFsplit
mod5 <- glmmPQL(data=BombSurv, fixed = virusBINY~apiary_near_far*target_name, random = ~ 1 | site, family = binomial (link = "logit"))
summary(mod5)
mod6 <- glmmPQL(data=DFsplit$DWV, fixed = norm_genome_copbee~apiary_near_far, random = ~ 1 |site + species, family = gaussian())
summary(mod6)
DFsplit$BQCV$HBSiteBin
mod3 <- glmmPQL(data=x$BQCV, fixed = BombPrev~apiary_near_far, random = ~ 1 | site, family = gaussian)
summary(mod3)
mod4 <- glmmPQL(data=x$DWV, fixed = BombPrev~apiary_near_far + sumApiaries, random = ~ 1 | site, family = gaussian)
summary(mod4)
library(lme4)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY~ sumApiaries + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(BQCVmod)
DWVmod <- glmer(data=DFsplit$DWV, formula = virusBINY~apiary_near_far + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(DWVmod)
DWVpos <- subset(DFsplit$DWV, virusBINY==1)
DWVpos$log10norm_genome_copbee <- log10(DWVpos$norm_genome_copbee)
lmermod1.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ apiary_near_far + (1|site) + (1|species), REML = FALSE)
lmermod1 <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(lmermod1.null,lmermod1)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY~ sumApiaries + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(BQCVmod)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY~ sumApiaries + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"), glmerControl(optimizer = "bobyqa", optCtrl = list(maxfun = 100000)))
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY ~ apiary_near_far + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(BQCVmod)
DWVmod <- glmer(data=DFsplit$DWV, formula = virusBINY~apiary_near_far + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(DWVmod)
lmermod1.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
lmermod1 <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(lmermod1.null,lmermod1)
lmermod1.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species))
lmermod1 <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site) + (1|species))
anova(lmermod1.null,lmermod1)
lmermod1.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site), REML = FALSE)
lmermod1 <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site), REML = FALSE)
anova(lmermod1.null,lmermod1)
lmermod1.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
lmermod1 <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(lmermod1.null,lmermod1)
lmermod1.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
lmermod1 <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
anova(lmermod1.null,lmermod1)
lmermod1.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ 1, REML = FALSE)
lmermod1.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
lmermod1 <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
anova(lmermod1.null,lmermod1)
DWVvl.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
DWVvl <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
anova(DWVvl.null,DWVvl)
BQCVpos <- subset(DFsplit$BQCV, virusBINY==1)
BQCVpos$log10norm_genome_copbee <- log10(BQCVpos$norm_genome_copbee)
BQCVpos$log10norm_genome_copbee
hist(BQCVpos$log10norm_genome_copbee)
BQVCvl.null <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
BQVCvl <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
anova(BQVCvl.null,BQVCvl)
DWVvl.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
DWVvl <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(DWVvl.null,DWVvl)
BQCVpos <- subset(DFsplit$BQCV, virusBINY==1)
BQCVpos$log10norm_genome_copbee <- log10(BQCVpos$norm_genome_copbee)
BQVCvl.null <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
BQVCvl <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(BQVCvl.null,BQVCvl)
BQVCvl.null <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
BQVCvl <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
anova(BQVCvl.null,BQVCvl)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY ~ apiary_near_far + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(BQCVmod)
DWVmod <- glmer(data=DFsplit$DWV, formula = virusBINY~apiary_near_far + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(DWVmod)
DWVpos <- subset(DFsplit$DWV, virusBINY==1)
DWVpos$log10norm_genome_copbee <- log10(DWVpos$norm_genome_copbee)
DWVvl.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
DWVvl <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
anova(DWVvl.null,DWVvl)
DWVpos <- subset(DFsplit$DWV, virusBINY==1)
DWVpos$log10norm_genome_copbee <- log10(DWVpos$norm_genome_copbee)
DWVvl.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
DWVvl <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
anova(DWVvl.null,DWVvl)
coef(DWVvl)
BQCVpos <- subset(DFsplit$BQCV, virusBINY==1)
BQCVpos$log10norm_genome_copbee <- log10(BQCVpos$norm_genome_copbee)
BQVCvl.null <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
BQVCvl <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
anova(BQVCvl.null,BQVCvl)
BQVCvl.null <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
BQVCvl <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(BQVCvl.null,BQVCvl)
BQVCvl.null <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ apiary_near_far + (1|site) + (1|species), REML = FALSE)
BQVCvl <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(BQVCvl.null,BQVCvl)
DWVvl.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
DWVvl <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + apiary_near_far (1|site) + (1|species), REML = FALSE)
DWVvl.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
DWVvl <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(DWVvl.null,DWVvl)
DWVvl.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ apiary_near_far + (1|site) + (1|species), REML = FALSE)
DWVvl <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(DWVvl.null,DWVvl)
coef(DWVvl)
DWVvl.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ apiary_near_far + (1|site) + (1|species), REML = FALSE)
DWVvl <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(DWVvl.null,DWVvl)
coef(DWVvl)
DWVvl.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ apiary_near_far + (1|site) + (1|species), REML = FALSE)
DWVvl <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(DWVvl.null,DWVvl)
DWVvl.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
DWVvl <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
anova(DWVvl.null,DWVvl)
BQCVpos <- subset(DFsplit$BQCV, virusBINY==1)
BQCVpos$log10norm_genome_copbee <- log10(BQCVpos$norm_genome_copbee)
BQVCvl.null <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ apiary_near_far + (1|site) + (1|species), REML = FALSE)
BQVCvl <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(BQVCvl.null,BQVCvl)
BQVCvl.null <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
BQVCvl <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
anova(BQVCvl.null,BQVCvl)
BQVCvl.null <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
BQVCvl <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ sumApiaries + apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(BQVCvl.null,BQVCvl)
BQVCvl.null <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
BQVCvl <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ apiary_near_far + (1|site) + (1|species), REML = FALSE)
anova(BQVCvl.null,BQVCvl)
BQVCvl.null <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
BQVCvl <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
anova(BQVCvl.null,BQVCvl)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY ~ apiary_near_far + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(BQCVmod)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY ~ sumApiaries + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(BQCVmod)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY ~ sumApiaries + apiary_near_far + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(BQCVmod)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY ~ apiary_near_far + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(BQCVmod)
DWVmod <- glmer(data=DFsplit$DWV, formula = virusBINY~apiary_near_far + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(DWVmod)
DWVmod <- glmer(data=DFsplit$DWV, formula = virusBINY ~ sumApiaries + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(DWVmod)
DWVmod <- glmer(data=DFsplit$DWV, formula = virusBINY ~ apiary_near_far + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(DWVmod)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY ~ apiary_near_far + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(BQCVmod)
BQVCvl.null <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species)+ (1|lat) + (1|long), REML = FALSE)
BQVCvl <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species)+ (1|lat) + (1|long), REML = FALSE)
anova(BQVCvl.null,BQVCvl)
DWVmod <- glmer(data=DFsplit$DWV, formula = virusBINY ~ shannonDIV + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
DWVmod <- glmer(data=DFsplit$DWV, formula = virusBINY ~ shanonDIV + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
str(DFsplit$DWV)
DWVmod <- glmer(data=DFsplit$DWV, formula = virusBINY ~ ShannonDIV + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(DWVmod)
DWVmod <- glmer(data=DFsplit$DWV, formula = virusBINY ~ Density + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(DWVmod)
DWVmod <- glmer(data=BombSurv, formula = virusBINY ~ Density * target_name + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY ~ ShannonDIV + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(BQCVmod)
BQCVmod <- glmer(data=DFsplit$BQCV, formula = virusBINY ~ Density + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(BQCVmod)
DWVmod <- glmer(data=DFsplit$DWV, formula = virusBINY ~ norm_genome_copbeeHB + (1|site) + (1|species) + (1|lat) + (1|long), family=binomial(link = "logit"))
summary(DWVmod)
BQVCvl.null <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
BQCVpos <- subset(DFsplit$BQCV, virusBINY==1)
BQCVpos$log10norm_genome_copbee <- log10(BQCVpos$norm_genome_copbee)
BQVCvl.null <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
BQVCvl <- lmer(data=BQCVpos, formula = log10norm_genome_copbee ~ norm_genome_copbeeHB + (1|site) + (1|species), REML = FALSE)
anova(BQVCvl.null,BQVCvl)
DWVvl.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
DWVvl <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
anova(DWVvl.null,DWVvl)
DWVvl.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
DWVvl <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
anova(DWVvl.null,DWVvl)
DWVvl.null <- lmer(data=DWVpos, formula = norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
DWVvl <- lmer(data=DWVpos, formula = norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
anova(DWVvl.null,DWVvl)
DWVvl.null <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ 1 + (1|site) + (1|species), REML = FALSE)
DWVvl <- lmer(data=DWVpos, formula = log10norm_genome_copbee ~ sumApiaries + (1|site) + (1|species), REML = FALSE)
anova(DWVvl.null,DWVvl)
library(tcltk)
