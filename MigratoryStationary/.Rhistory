}
means <- colMeans(x$means)
X <- scale(X, center = means, scale = FALSE) %*% x$scaling
rtrn <- as.data.frame(cbind(X,labels=as.character(g)))
rtrn <- data.frame(X,labels=as.character(g))
return(rtrn)
}
# fit graph for LDA
fitGraph <- ggplotLDAPrep(time2)
# graph for LDA
LDAone <- ggplot(fitGraph, aes(LD1,LD2, color=labels))+geom_point(size=6) + theme_minimal(base_size = 20) + theme(legend.position = c(x=.82, y=.85), legend.background = element_rect(fill="white", size=.5), axis.line.x = element_line(colour = 'black', size=0.5, linetype='solid'), axis.line.y = element_line(colour = 'black', size=0.5, linetype='solid')) + stat_ellipse(show.legend = FALSE, level=.7) + labs(x="LD1 (88.36%)", y="LD2 (11.64%)") + scale_color_manual(values=c("black", "red", "blue"), name="Treatment:",breaks=c("Exposed", "Migratory", "Stationary"), labels=c("Exposed", "Migratory", "Stationary\n(Isolated)"))
LDAone
# EXP3 LDA
#######################################################
# run LDA
time3 <- lda(Treatment~Varroa + NosemaLoadRecount + logBQCV + logDWV + DWVbinary + FOB + BroodPattern + NosemaBinary + VarroaBinary, data=Mig3, na.action="na.omit")
# graph for LDA
fitGraph1 <- ggplotLDAPrep(time3)
# graph for LDA
LDAtwo <- ggplot(fitGraph1, aes(LD1,LD2, color=labels))+geom_point(size=6) + theme_minimal(base_size = 20) + scale_colour_manual(values = c("black", "red","blue" )) + theme(legend.position = "none", axis.line.x = element_line(colour = 'black', size=0.5, linetype='solid'), axis.line.y = element_line(colour = 'black', size=0.5, linetype='solid')) + stat_ellipse(show.legend = FALSE, level=.7) + labs(color="Treatment:", x="LD1 (68.73%)", y="LD2 (31.27%)")
LDAtwo
plot_grid(LDAone, LDAtwo, labels = c("A", "B"), align="hv")
# EXP2 LDA
#######################################################
# create seperate data frames for each time point:
MigStatSplit <- split(MigStat, MigStat$SamplingEvent)
Mig1 <- MigStatSplit$`1`
Mig2 <- MigStatSplit$`2`
Mig3 <- MigStatSplit$`3`
# run LDA
time2 <- lda(Treatment~Varroa + NosemaLoadRecount + logBQCV + logDWV + DWVbinary + FOB + BroodPattern + NosemaBinary + VarroaBinary, data=Mig2, na.action="na.omit")
# LDA prep function
ggplotLDAPrep <- function(x){
if (!is.null(Terms <- x$terms)) {
data <- model.frame(x)
X <- model.matrix(delete.response(Terms), data)
g <- model.response(data)
xint <- match("(Intercept)", colnames(X), nomatch = 0L)
if (xint > 0L)
X <- X[, -xint, drop = FALSE]
}
means <- colMeans(x$means)
X <- scale(X, center = means, scale = FALSE) %*% x$scaling
rtrn <- as.data.frame(cbind(X,labels=as.character(g)))
rtrn <- data.frame(X,labels=as.character(g))
return(rtrn)
}
# fit graph for LDA
fitGraph <- ggplotLDAPrep(time2)
# graph for LDA
LDAone <- ggplot(fitGraph, aes(LD1,LD2, color=labels))+geom_point(size=6) + theme_minimal(base_size = 30) + theme(legend.position = c(x=.82, y=.85), legend.background = element_rect(fill="white", size=.5), axis.line.x = element_line(colour = 'black', size=0.5, linetype='solid'), axis.line.y = element_line(colour = 'black', size=0.5, linetype='solid')) + stat_ellipse(show.legend = FALSE, level=.7) + labs(x="LD1 (88.36%)", y="LD2 (11.64%)") + scale_color_manual(values=c("black", "red", "blue"), name="Treatment:",breaks=c("Exposed", "Migratory", "Stationary"), labels=c("Exposed", "Migratory", "Stationary\n(Isolated)"))
LDAone
# EXP3 LDA
#######################################################
# run LDA
time3 <- lda(Treatment~Varroa + NosemaLoadRecount + logBQCV + logDWV + DWVbinary + FOB + BroodPattern + NosemaBinary + VarroaBinary, data=Mig3, na.action="na.omit")
# graph for LDA
fitGraph1 <- ggplotLDAPrep(time3)
# graph for LDA
LDAtwo <- ggplot(fitGraph1, aes(LD1,LD2, color=labels))+geom_point(size=6) + theme_minimal(base_size = 30) + scale_colour_manual(values = c("black", "red","blue" )) + theme(legend.position= "none", axis.line.x = element_line(colour = 'black', size=0.5, linetype='solid'), axis.line.y = element_line(colour = 'black', size=0.5, linetype='solid')) + stat_ellipse(show.legend = FALSE, level=.7) + labs(color="Treatment:", x="LD1 (68.73%)", y="LD2 (31.27%)")
LDAtwo
# merge into one panel
#####################################################################################
############
plot_grid(BQCVload2, DWVload2, VARload2, FOB3, labels = c("A", "B", "C", "D"), ncol = 2,  align="hv")
plot_grid(LDAone, LDAtwo, labels = c("A", "B"), align="hv")
# create seperate data frames for each time point:
MigStatSplit <- split(MigStat, MigStat$SamplingEvent)
Mig1 <- MigStatSplit$`1`
Mig2 <- MigStatSplit$`2`
Mig3 <- MigStatSplit$`3`
# run LDA
time2 <- lda(Treatment~Varroa + NosemaLoadRecount + logBQCV + logDWV + DWVbinary + FOB + BroodPattern + NosemaBinary + VarroaBinary, data=Mig2, na.action="na.omit")
# LDA prep function
ggplotLDAPrep <- function(x){
if (!is.null(Terms <- x$terms)) {
data <- model.frame(x)
X <- model.matrix(delete.response(Terms), data)
g <- model.response(data)
xint <- match("(Intercept)", colnames(X), nomatch = 0L)
if (xint > 0L)
X <- X[, -xint, drop = FALSE]
}
means <- colMeans(x$means)
X <- scale(X, center = means, scale = FALSE) %*% x$scaling
rtrn <- as.data.frame(cbind(X,labels=as.character(g)))
rtrn <- data.frame(X,labels=as.character(g))
return(rtrn)
}
# fit graph for LDA
fitGraph <- ggplotLDAPrep(time2)
# graph for LDA
LDAone <- ggplot(fitGraph, aes(LD1,LD2, color=labels))+geom_point(size=6) + theme_minimal(base_size = 25) + theme(legend.position = c(x=.82, y=.85), legend.background = element_rect(fill="white", size=.5), axis.line.x = element_line(colour = 'black', size=0.5, linetype='solid'), axis.line.y = element_line(colour = 'black', size=0.5, linetype='solid')) + stat_ellipse(show.legend = FALSE, level=.7) + labs(x="LD1 (88.36%)", y="LD2 (11.64%)") + scale_color_manual(values=c("black", "red", "blue"), name="Treatment:",breaks=c("Exposed", "Migratory", "Stationary"), labels=c("Exposed", "Migratory", "Stationary\n(Isolated)"))
LDAone
# EXP3 LDA
#######################################################
# run LDA
time3 <- lda(Treatment~Varroa + NosemaLoadRecount + logBQCV + logDWV + DWVbinary + FOB + BroodPattern + NosemaBinary + VarroaBinary, data=Mig3, na.action="na.omit")
# graph for LDA
fitGraph1 <- ggplotLDAPrep(time3)
# graph for LDA
LDAtwo <- ggplot(fitGraph1, aes(LD1,LD2, color=labels))+geom_point(size=6) + theme_minimal(base_size = 25) + scale_colour_manual(values = c("black", "red","blue" )) + theme(legend.position= "none", axis.line.x = element_line(colour = 'black', size=0.5, linetype='solid'), axis.line.y = element_line(colour = 'black', size=0.5, linetype='solid')) + stat_ellipse(show.legend = FALSE, level=.7) + labs(color="Treatment:", x="LD1 (68.73%)", y="LD2 (31.27%)")
LDAtwo
# merge into one panel
##################
plot_grid(LDAone, LDAtwo, labels = c("A", "B"), align="hv")
################################################################
# DWV LOAD
#####################################################################################
# Summary of DWV VL for experiment 2
VirusSum6 <- ddply(MigStat, c("Treatment", "SamplingEvent"), summarise,
n = length(logDWV),
mean = mean(logDWV, na.rm=TRUE),
sd = sd(logDWV, na.rm = TRUE),
se = sd / sqrt(n))
# plotting DWV VL for experiment 2
DWVload2 <- ggplot(data = VirusSum6,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "DWV log(genome copies/bee)") + coord_cartesian(ylim = c(0, 17), xlim = c(1,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=1.5) + theme_classic(base_size = 25) + theme(legend.position="none")+ scale_x_continuous(breaks=c(1,2,3))
DWVload2
# BQCV LOAD
#####################################################################################
# Summary of BQCV VL for experiment 2
VirusSum8 <- ddply(MigStat, c("Treatment", "SamplingEvent"), summarise,
n = length(logBQCV),
mean = mean(logBQCV, na.rm=TRUE),
sd = sd(logBQCV, na.rm = TRUE),
se = sd / sqrt(n))
# plotting BQCV VL for experiment 2
BQCVload2 <- ggplot(data = VirusSum8,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "BQCV log(genome copies/bee)") + coord_cartesian(ylim = c(10, 25), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=1.5) + theme_classic(base_size = 25) + theme(legend.position=c(.3, .85), legend.key.width=unit(5,"line")) + scale_x_continuous(breaks=c(1,2,3))
BQCVload2
# Varroa LOAD
#####################################################################################
# Summary of varroa load for experiment 2
VarSum2 <- ddply(MigStat, c("Treatment", "SamplingEvent"), summarise,
n = length(Varroa),
mean = mean(Varroa, na.rm=TRUE),
sd = sd(Varroa, na.rm = TRUE),
se = sd / sqrt(n))
# plotting varroa load for experiment 2
VARload2 <- ggplot(data = VarSum2,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = "Sampling Event", y = "Varroa (mites/100 bees)") + coord_cartesian(ylim = c(0, 5), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=1.5) + theme_classic(base_size = 25) + theme(legend.position="none") + scale_x_continuous(breaks=c(1,2,3))
VARload2
# FOB
#####################################################################################
# Summary of FOB for experiment 2
FOB2 <- ddply(MigStat, c("Treatment", "SamplingEvent"), summarise,
n = length(FOB),
mean = mean(FOB, na.rm=TRUE),
sd = sd(FOB, na.rm = TRUE),
se = sd / sqrt(n))
# plotting FOB for experiment 2
FOB3 <- ggplot(data = FOB2,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = "Sampling Event", y = "Frames of Bees") + coord_cartesian(ylim = c(6, 30), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=1.5) + theme_classic(base_size = 25) + theme(legend.position="none") + scale_x_continuous(breaks=c(1,2,3))
FOB3
# EXP2 LDA
###########################
plot_grid(BQCVload2, DWVload2, VARload2, FOB3, labels = c("A", "B", "C", "D"), ncol = 2,  align="hv")
plot_grid(BQCVload2, DWVload2, VARload2, FOB3, labels = c("A", "B", "C", "D"), ncol = 2,  align="hv", label_size = 17)
plot_grid(LDAone, LDAtwo, labels = c("A", "B"), align="hv",  label_size = 17)
plot_grid(LDAone, LDAtwo, labels = c("A", "B"), align="hv",  label_size = 25)
setwd("~/AlgerProjects/MigratoryStationary/")
MigStat <- read.table("Data/MigStatClean.csv",
header=TRUE,
sep = ",",
stringsAsFactors = FALSE)
MigStat$Treatment <- ifelse(MigStat$Treatment=="Stationary","Stationary\n(Isolated)", ifelse(MigStat$Treatment=="Migratory", "Migratory", "Exposed"))
MigStat$NosemaLoadRecount1 <- ((MigStat$NosemaLoadRecount*4000000)/80)/100000
# DWV LOAD
#####################################################################################
# Summary of DWV VL for experiment 2
VirusSum6 <- ddply(MigStat, c("Treatment", "SamplingEvent"), summarise,
n = length(logDWV),
mean = mean(logDWV, na.rm=TRUE),
sd = sd(logDWV, na.rm = TRUE),
se = sd / sqrt(n))
# plotting DWV VL for experiment 2
DWVload2 <- ggplot(data = VirusSum6,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "DWV log(genome copies/bee)") + coord_cartesian(ylim = c(0, 17), xlim = c(1,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 25) + theme(legend.position="none")+ scale_x_continuous(breaks=c(1,2,3))
DWVload2
# BQCV LOAD
#####################################################################################
# Summary of BQCV VL for experiment 2
VirusSum8 <- ddply(MigStat, c("Treatment", "SamplingEvent"), summarise,
n = length(logBQCV),
mean = mean(logBQCV, na.rm=TRUE),
sd = sd(logBQCV, na.rm = TRUE),
se = sd / sqrt(n))
# plotting BQCV VL for experiment 2
BQCVload2 <- ggplot(data = VirusSum8,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "BQCV log(genome copies/bee)") + coord_cartesian(ylim = c(10, 25), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 25) + theme(legend.position=c(.3, .85), legend.key.width=unit(5,"line")) + scale_x_continuous(breaks=c(1,2,3))
BQCVload2
# Varroa LOAD
#####################################################################################
# Summary of varroa load for experiment 2
VarSum2 <- ddply(MigStat, c("Treatment", "SamplingEvent"), summarise,
n = length(Varroa),
mean = mean(Varroa, na.rm=TRUE),
sd = sd(Varroa, na.rm = TRUE),
se = sd / sqrt(n))
# plotting varroa load for experiment 2
VARload2 <- ggplot(data = VarSum2,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = "Sampling Event", y = "Varroa (mites/100 bees)") + coord_cartesian(ylim = c(0, 5), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 25) + theme(legend.position="none") + scale_x_continuous(breaks=c(1,2,3))
VARload2
# FOB
#####################################################################################
# Summary of FOB for experiment 2
FOB2 <- ddply(MigStat, c("Treatment", "SamplingEvent"), summarise,
n = length(FOB),
mean = mean(FOB, na.rm=TRUE),
sd = sd(FOB, na.rm = TRUE),
se = sd / sqrt(n))
# plotting FOB for experiment 2
FOB3 <- ggplot(data = FOB2,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = "Sampling Event", y = "Frames of Bees") + coord_cartesian(ylim = c(6, 30), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 25) + theme(legend.position="none") + scale_x_continuous(breaks=c(1,2,3))
FOB3
plot_grid(BQCVload2, DWVload2, VARload2, FOB3, labels = c("A", "B", "C", "D"), ncol = 2,  align="hv", label_size = 25)
BQCVload2 <- ggplot(data = VirusSum8,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "BQCV log(genome copies/bee)") + coord_cartesian(ylim = c(10, 25), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 25) + theme(legend.position=c(.1, .85), legend.key.width=unit(5,"line")) + scale_x_continuous(breaks=c(1,2,3))
BQCVload2
plot_grid(BQCVload2, DWVload2, VARload2, FOB3, labels = c("A", "B", "C", "D"), ncol = 2,  align="hv", label_size = 25)
BQCVload2 <- ggplot(data = VirusSum8,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "BQCV log(genome copies/bee)") + coord_cartesian(ylim = c(10, 25), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 25) + theme(legend.position=c(.1, .85), legend.key.width=unit(5,"line"), legend.key.height = 5, "line") + scale_x_continuous(breaks=c(1,2,3))
BQCVload2
BQCVload2 <- ggplot(data = VirusSum8,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "BQCV log(genome copies/bee)") + coord_cartesian(ylim = c(10, 25), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 25) + theme(legend.position=c(.1, .85), legend.key.width=unit(5,"line"), legend.key.height = 10, "line") + scale_x_continuous(breaks=c(1,2,3))
BQCVload2 <- ggplot(data = VirusSum8,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "BQCV log(genome copies/bee)") + coord_cartesian(ylim = c(10, 25), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 25) + theme(legend.position=c(.1, .85), legend.key.width=unit(5,"line"), legend.key.height = 10, "line") + scale_x_continuous(breaks=c(1,2,3))
BQCVload2
BQCVload2 <- ggplot(data = VirusSum8,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "BQCV log(genome copies/bee)") + coord_cartesian(ylim = c(10, 25), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 25) + theme(legend.position=c(.1, .85), legend.key.width=unit(5,"line"), legend.key.height = 5, "line") + scale_x_continuous(breaks=c(1,2,3))
BQCVload2 <- ggplot(data = VirusSum8,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "BQCV log(genome copies/bee)") + coord_cartesian(ylim = c(10, 25), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 25) + theme(legend.position=c(.1, .85), legend.key.width=unit(5,"line"), legend.key.height = unit(5, "line")) + scale_x_continuous(breaks=c(1,2,3))
BQCVload2
BQCVload2 <- ggplot(data = VirusSum8,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "BQCV log(genome copies/bee)") + coord_cartesian(ylim = c(10, 25), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 25) + theme(legend.position=c(.1, .85), legend.key.width=unit(5,"line"), legend.key.height = unit(3, "line")) + scale_x_continuous(breaks=c(1,2,3))
BQCVload2
# DWV LOAD
#####################################################################################
# Summary of DWV VL for experiment 2
VirusSum6 <- ddply(MigStat, c("Treatment", "SamplingEvent"), summarise,
n = length(logDWV),
mean = mean(logDWV, na.rm=TRUE),
sd = sd(logDWV, na.rm = TRUE),
se = sd / sqrt(n))
# plotting DWV VL for experiment 2
DWVload2 <- ggplot(data = VirusSum6,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "DWV log(genome copies/bee)") + coord_cartesian(ylim = c(0, 17), xlim = c(1,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 30) + theme(legend.position="none")+ scale_x_continuous(breaks=c(1,2,3))
DWVload2
# BQCV LOAD
#####################################################################################
# Summary of BQCV VL for experiment 2
VirusSum8 <- ddply(MigStat, c("Treatment", "SamplingEvent"), summarise,
n = length(logBQCV),
mean = mean(logBQCV, na.rm=TRUE),
sd = sd(logBQCV, na.rm = TRUE),
se = sd / sqrt(n))
# plotting BQCV VL for experiment 2
BQCVload2 <- ggplot(data = VirusSum8,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "BQCV log(genome copies/bee)") + coord_cartesian(ylim = c(10, 25), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 30) + theme(legend.position=c(.1, .85), legend.key.width=unit(5,"line"), legend.key.height = unit(3, "line")) + scale_x_continuous(breaks=c(1,2,3))
BQCVload2
# Varroa LOAD
#####################################################################################
# Summary of varroa load for experiment 2
VarSum2 <- ddply(MigStat, c("Treatment", "SamplingEvent"), summarise,
n = length(Varroa),
mean = mean(Varroa, na.rm=TRUE),
sd = sd(Varroa, na.rm = TRUE),
se = sd / sqrt(n))
# plotting varroa load for experiment 2
VARload2 <- ggplot(data = VarSum2,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = "Sampling Event", y = "Varroa (mites/100 bees)") + coord_cartesian(ylim = c(0, 5), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 30) + theme(legend.position="none") + scale_x_continuous(breaks=c(1,2,3))
VARload2
# FOB
#####################################################################################
# Summary of FOB for experiment 2
FOB2 <- ddply(MigStat, c("Treatment", "SamplingEvent"), summarise,
n = length(FOB),
mean = mean(FOB, na.rm=TRUE),
sd = sd(FOB, na.rm = TRUE),
se = sd / sqrt(n))
# plotting FOB for experiment 2
FOB3 <- ggplot(data = FOB2,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = "Sampling Event", y = "Frames of Bees") + coord_cartesian(ylim = c(6, 30), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 30) + theme(legend.position="none") + scale_x_continuous(breaks=c(1,2,3))
FOB3
plot_grid(BQCVload2, DWVload2, VARload2, FOB3, labels = c("A", "B", "C", "D"), ncol = 2,  align="hv", label_size = 25)
BQCVload2 <- ggplot(data = VirusSum8,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "BQCV log(genome copies/bee)") + coord_cartesian(ylim = c(10, 25), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 30) + theme(legend.position=c(.3, .85), legend.key.width=unit(7,"line"), legend.key.height = unit(3, "line")) + scale_x_continuous(breaks=c(1,2,3))
BQCVload2
BQCVload2 <- ggplot(data = VirusSum8,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "BQCV log(genome copies/bee)") + coord_cartesian(ylim = c(10, 25), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 30) + theme(legend.position=c(.3, .85), legend.key.width=unit(8,"line"), legend.key.height = unit(3, "line")) + scale_x_continuous(breaks=c(1,2,3))
BQCVload2
BQCVload2 <- ggplot(data = VirusSum8,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "BQCV log(genome copies/bee)") + coord_cartesian(ylim = c(10, 25), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 30) + theme(legend.position=c(.3, .85), legend.key.width=unit(7,"line"), legend.key.height = unit(3, "line")) + scale_x_continuous(breaks=c(1,2,3))
BQCVload2
plot_grid(BQCVload2, DWVload2, VARload2, FOB3, labels = c("A", "B", "C", "D"), ncol = 2,  align="hv", label_size = 30)
MigStat <- read.table("Data/MigStatClean.csv",
header=TRUE,
sep = ",",
stringsAsFactors = FALSE)
MigStatSplit <- split(MigStat, MigStat$SamplingEvent)
Mig1 <- MigStatSplit$`1`
Mig2 <- MigStatSplit$`2`
Mig3 <- MigStatSplit$`3`
time2 <- lda(Treatment~Varroa + NosemaLoadRecount + logBQCV + logDWV + DWVbinary + FOB + BroodPattern + NosemaBinary + VarroaBinary, data=Mig2, na.action="na.omit")
ggplotLDAPrep <- function(x){
if (!is.null(Terms <- x$terms)) {
data <- model.frame(x)
X <- model.matrix(delete.response(Terms), data)
g <- model.response(data)
xint <- match("(Intercept)", colnames(X), nomatch = 0L)
if (xint > 0L)
X <- X[, -xint, drop = FALSE]
}
means <- colMeans(x$means)
X <- scale(X, center = means, scale = FALSE) %*% x$scaling
rtrn <- as.data.frame(cbind(X,labels=as.character(g)))
rtrn <- data.frame(X,labels=as.character(g))
return(rtrn)
}
fitGraph <- ggplotLDAPrep(time2)
LDAone <- ggplot(fitGraph, aes(LD1,LD2, color=labels))+geom_point(size=6) + theme_minimal(base_size = 30) + theme(legend.key.width=unit(7,"line"), legend.key.height = unit(3, "line"), legend.position = c(x=.82, y=.85), legend.background = element_rect(fill="white", size=.5), axis.line.x = element_line(colour = 'black', size=0.5, linetype='solid'), axis.line.y = element_line(colour = 'black', size=0.5, linetype='solid')) + stat_ellipse(show.legend = FALSE, level=.7) + labs(x="LD1 (88.36%)", y="LD2 (11.64%)") + scale_color_manual(values=c("black", "red", "blue"), name="Treatment:",breaks=c("Exposed", "Migratory", "Stationary"), labels=c("Exposed", "Migratory", "Stationary\n(Isolated)"))
LDAone
time3 <- lda(Treatment~Varroa + NosemaLoadRecount + logBQCV + logDWV + DWVbinary + FOB + BroodPattern + NosemaBinary + VarroaBinary, data=Mig3, na.action="na.omit")
fitGraph1 <- ggplotLDAPrep(time3)
LDAtwo <- ggplot(fitGraph1, aes(LD1,LD2, color=labels))+geom_point(size=6) + theme_minimal(base_size = 25) + scale_colour_manual(values = c("black", "red","blue" )) + theme(legend.position= "none", axis.line.x = element_line(colour = 'black', size=0.5, linetype='solid'), axis.line.y = element_line(colour = 'black', size=0.5, linetype='solid')) + stat_ellipse(show.legend = FALSE, level=.7) + labs(color="Treatment:", x="LD1 (68.73%)", y="LD2 (31.27%)")
LDAtwo <- ggplot(fitGraph1, aes(LD1,LD2, color=labels))+geom_point(size=6) + theme_minimal(base_size = 30) + scale_colour_manual(values = c("black", "red","blue" )) + theme(legend.position= "none", axis.line.x = element_line(colour = 'black', size=0.5, linetype='solid'), axis.line.y = element_line(colour = 'black', size=0.5, linetype='solid')) + stat_ellipse(show.legend = FALSE, level=.7) + labs(color="Treatment:", x="LD1 (68.73%)", y="LD2 (31.27%)")
LDAtwo
plot_grid(LDAone, LDAtwo, labels = c("A", "B"), align="hv",  label_size = 30)
LDAone <- ggplot(fitGraph, aes(LD1,LD2, color=labels))+geom_point(size=6) + theme_minimal(base_size = 30) + theme(legend.key.height = unit(3, "line"), legend.position = c(x=.82, y=.85), legend.background = element_rect(fill="white", size=.5), axis.line.x = element_line(colour = 'black', size=0.5, linetype='solid'), axis.line.y = element_line(colour = 'black', size=0.5, linetype='solid')) + stat_ellipse(show.legend = FALSE, level=.7) + labs(x="LD1 (88.36%)", y="LD2 (11.64%)") + scale_color_manual(values=c("black", "red", "blue"), name="Treatment:",breaks=c("Exposed", "Migratory", "Stationary"), labels=c("Exposed", "Migratory", "Stationary\n(Isolated)"))
LDAone
plot_grid(LDAone, LDAtwo, labels = c("A", "B"), align="hv",  label_size = 30)
LDAone <- ggplot(fitGraph, aes(LD1,LD2, color=labels))+geom_point(size=6) + theme_minimal(base_size = 30) + theme(legend.key.height = unit(3, "line"), legend.position = c(x=.82, y=.85), legend.background = element_rect(fill="white", size=.5), axis.line.x = element_line(colour = 'black', size=0.5, linetype='solid'), axis.line.y = element_line(colour = 'black', size=0.5, linetype='solid')) + stat_ellipse(show.legend = FALSE, level=.7) + labs(x="LD1 (88.36%)", y="LD2 (11.64%)") + scale_color_manual(values=c("black", "red", "blue"), name="Treatment",breaks=c("Exposed", "Migratory", "Stationary"), labels=c("Exposed", "Migratory", "Stationary\n(Isolated)"))
LDAone
plot_grid(LDAone, LDAtwo, labels = c("A", "B"), align="hv",  label_size = 30)
LDAone <- ggplot(fitGraph, aes(LD1,LD2, color=labels))+geom_point(size=6) + theme_minimal(base_size = 30) + theme(legend.key.width = unit(3, "line"), legend.key.height = unit(3, "line"), legend.position = c(x=.82, y=.85), legend.background = element_rect(fill="white", size=.5), axis.line.x = element_line(colour = 'black', size=0.5, linetype='solid'), axis.line.y = element_line(colour = 'black', size=0.5, linetype='solid')) + stat_ellipse(show.legend = FALSE, level=.7) + labs(x="LD1 (88.36%)", y="LD2 (11.64%)") + scale_color_manual(values=c("black", "red", "blue"), name="Treatment",breaks=c("Exposed", "Migratory", "Stationary"), labels=c("Exposed", "Migratory", "Stationary\n(Isolated)"))
LDAone
plot_grid(LDAone, LDAtwo, labels = c("A", "B"), align="hv",  label_size = 30)
rm(list=ls())
setwd("~/AlgerProjects/MigratoryStationary/")
MigStat <- read.table("Data/MigStatClean.csv",
header=TRUE,
sep = ",",
stringsAsFactors = FALSE)
MigStat$Treatment <- ifelse(MigStat$Treatment=="Stationary","Stationary\n(Isolated)", ifelse(MigStat$Treatment=="Migratory", "Migratory", "Exposed"))
MigStat$NosemaLoadRecount1 <- ((MigStat$NosemaLoadRecount*4000000)/80)/100000
# DWV LOAD
#####################################################################################
# Summary of DWV VL for experiment 2
VirusSum6 <- ddply(MigStat, c("Treatment", "SamplingEvent"), summarise,
n = length(logDWV),
mean = mean(logDWV, na.rm=TRUE),
sd = sd(logDWV, na.rm = TRUE),
se = sd / sqrt(n))
# plotting DWV VL for experiment 2
DWVload2 <- ggplot(data = VirusSum6,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "DWV log(genome copies/bee)") + coord_cartesian(ylim = c(0, 17), xlim = c(1,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 30) + theme(legend.position="none")+ scale_x_continuous(breaks=c(1,2,3))
DWVload2
# BQCV LOAD
#####################################################################################
# Summary of BQCV VL for experiment 2
VirusSum8 <- ddply(MigStat, c("Treatment", "SamplingEvent"), summarise,
n = length(logBQCV),
mean = mean(logBQCV, na.rm=TRUE),
sd = sd(logBQCV, na.rm = TRUE),
se = sd / sqrt(n))
# plotting BQCV VL for experiment 2
BQCVload2 <- ggplot(data = VirusSum8,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "BQCV log(genome copies/bee)") + coord_cartesian(ylim = c(10, 25), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 30) + theme(legend.position=c(.3, .85), legend.key.width=unit(7,"line"), legend.key.height = unit(3, "line")) + scale_x_continuous(breaks=c(1,2,3))
BQCVload2
# Varroa LOAD
#####################################################################################
# Summary of varroa load for experiment 2
VarSum2 <- ddply(MigStat, c("Treatment", "SamplingEvent"), summarise,
n = length(Varroa),
mean = mean(Varroa, na.rm=TRUE),
sd = sd(Varroa, na.rm = TRUE),
se = sd / sqrt(n))
# plotting varroa load for experiment 2
VARload2 <- ggplot(data = VarSum2,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = "Sampling Event", y = "Varroa (mites/100 bees)") + coord_cartesian(ylim = c(0, 5), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 30) + theme(legend.position="none") + scale_x_continuous(breaks=c(1,2,3))
VARload2
# FOB
#####################################################################################
# Summary of FOB for experiment 2
FOB2 <- ddply(MigStat, c("Treatment", "SamplingEvent"), summarise,
n = length(FOB),
mean = mean(FOB, na.rm=TRUE),
sd = sd(FOB, na.rm = TRUE),
se = sd / sqrt(n))
# plotting FOB for experiment 2
FOB3 <- ggplot(data = FOB2,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = "Sampling Event", y = "Frames of Bees") + coord_cartesian(ylim = c(6, 30), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 30) + theme(legend.position="none") + scale_x_continuous(breaks=c(1,2,3))
FOB3
plot_grid(BQCVload2, DWVload2, VARload2, FOB3, labels = c("A", "B", "C", "D"), ncol = 2,  align="hv", label_size = 30)
VirusSum8 <- ddply(MigStat, c("Treatment", "SamplingEvent"), summarise,
n = length(logBQCV),
mean = mean(logBQCV, na.rm=TRUE),
sd = sd(logBQCV, na.rm = TRUE),
se = sd / sqrt(n))
BQCVload2 <- ggplot(data = VirusSum8,
aes(x = SamplingEvent,
y = mean,
col = Treatment,
linetype= Treatment)
) + geom_point(size=8) + scale_colour_manual(values = c("darkgrey","black", "black")) + scale_linetype_manual(values = c(1, 1, 2)) + labs(x = NULL, y = "BQCV log(genome copies/bee)") + coord_cartesian(ylim = c(10, 25), xlim = c(1,2,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05), linetype=1, show.legend=FALSE) + geom_line(size=3) + theme_classic(base_size = 30) + theme(legend.position=c(.2, .85), legend.key.width=unit(7,"line"), legend.key.height = unit(3, "line")) + scale_x_continuous(breaks=c(1,2,3))
BQCVload2
plot_grid(BQCVload2, DWVload2, VARload2, FOB3, labels = c("A", "B", "C", "D"), ncol = 2,  align="hv", label_size = 30)
