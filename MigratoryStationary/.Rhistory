position=position_dodge()) + labs(x="Gene", y = "log(Fold Change)") + geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width=.1, position=position_dodge(.9))
plot1 + theme_minimal(base_size = 17) + scale_fill_manual(values=colors, name="Health Status:") + theme(legend.position=c(.2, .85)) + coord_cartesian(ylim = c(-2, 2)) + annotate("segment", x = .5, xend = 2.5, y = meanCI, yend = meanCI, col = "red") + annotate("segment", x = .5, xend = 2.5, y = upper, yend = upper, col = "red", linetype = 2, size = 0.3) + annotate("segment", x = .5, xend = 2.5, y = lower, yend = lower, col = "red", linetype = 2, size = 0.3)
colors <- c("slategray3", "dodgerblue4")
#Create a bar graph for with CI and SE bars
plot1 <- ggplot(DF1, aes(x=Gene,
y=mean,
fill=HealthStat)) +
geom_bar(stat="identity",
position=position_dodge()) + labs(x="Gene", y = "log(Fold Change)") + geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width=.2, position=position_dodge(.9))
plot1 + theme_minimal(base_size = 17) + scale_fill_manual(values=colors, name="Health Status:") + theme(legend.position=c(.2, .85)) + coord_cartesian(ylim = c(-2, 2)) + annotate("segment", x = .5, xend = 2.5, y = meanCI, yend = meanCI, col = "red") + annotate("segment", x = .5, xend = 2.5, y = upper, yend = upper, col = "red", linetype = 2, size = 0.3) + annotate("segment", x = .5, xend = 2.5, y = lower, yend = lower, col = "red", linetype = 2, size = 0.3)
colors <- c("slategray3", "dodgerblue4")
plot1 <- ggplot(DF1, aes(x=Gene,
y=mean,
fill=HealthStat)) +
geom_bar(stat="identity",
color = "black",
position=position_dodge()) + labs(x="Gene", y = "log(Fold Change)") + geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width=.2, position=position_dodge(.9))
plot1 + theme_minimal(base_size = 17) + scale_fill_manual(values=colors, name="Health Status:") + theme(legend.position=c(.2, .85)) + coord_cartesian(ylim = c(-2, 2)) + annotate("segment", x = .5, xend = 2.5, y = meanCI, yend = meanCI, col = "red") + annotate("segment", x = .5, xend = 2.5, y = upper, yend = upper, col = "red", linetype = 2, size = 0.3) + annotate("segment", x = .5, xend = 2.5, y = lower, yend = lower, col = "red", linetype = 2, size = 0.3)
head(DF)
HealthStat <- rep(c("Sick","Sick","Healthy","Sick","Healthy","Healthy","Sick","Sick","Healthy","Sick","Healthy","Healthy","Sick","Sick","Healthy","Sick","Healthy","Healthy","Sick","Healthy"),2)
FoldChange <- rnorm(40, mean = 0, sd = 2)
FoldChangeBack <- rnorm(40, mean = 0, sd = 2)
Gene <- c(rep("Gene1", 20), rep("Gene2", 20))
DF <- data.frame(Gene, HealthStat, FoldChange, FoldChangeBack)
DF1 <- ddply(DF, c("HealthStat", "Gene"), summarise,
n = length(FoldChange),
mean = mean(FoldChange, na.rm=TRUE),
sd = sd(FoldChange, na.rm=TRUE),
se = sd / sqrt(n))
meanCI <- mean(DF$FoldChangeBack)
n <- length(DF$FoldChangeBack)
s <- sd(DF$FoldChangeBack)
MOE <- qnorm(0.975)*s/sqrt(n)
upper <- meanCI + MOE
lower <- meanCI - MOE
colors <- c("slategray3", "dodgerblue4")
plot1 <- ggplot(DF1, aes(x=Gene,
y=mean,
fill=HealthStat)) +
geom_bar(stat="identity",
color = "black",
position=position_dodge()) + labs(x="Gene", y = "log(Fold Change)") + geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width=.2, position=position_dodge(.9))
plot1 + theme_minimal(base_size = 17) + scale_fill_manual(values=colors, name="Health Status:") + theme(legend.position=c(.2, .85)) + coord_cartesian(ylim = c(-2, 2)) + annotate("segment", x = .5, xend = 2.5, y = meanCI, yend = meanCI, col = "red") + annotate("segment", x = .5, xend = 2.5, y = upper, yend = upper, col = "red", linetype = 2, size = 0.3) + annotate("segment", x = .5, xend = 2.5, y = lower, yend = lower, col = "red", linetype = 2, size = 0.3)
plot1 <- ggplot(DF1, aes(x=Gene,
y=mean,
fill=HealthStat)) +
geom_bar(stat="identity",
color = "black",
position=position_dodge()) + labs(x="Gene", y = "log(Fold Change)") + geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width=.2, position=position_dodge(.9))
plot1 + theme_minimal(base_size = 17) + scale_fill_manual(values=colors, name="Health Status:") + theme(legend.position=c(.2, .85)) + coord_cartesian(ylim = c(-2, 2)) + annotate("segment", x = .5, xend = 2.5, y = meanCI, yend = meanCI, col = "red") + annotate("segment", x = .5, xend = 2.5, y = upper, yend = upper, col = "red", linetype = 2, size = 0.3) + annotate("segment", x = .5, xend = 2.5, y = lower, yend = lower, col = "red", linetype = 2, size = 0.3)
qnorm(0.975)
hist(DF$FoldChangeBack)
model <- aov(data=DF, formula = FoldChange ~ HealthStat)
summary(model)
model <- aov(data=DF, formula = FoldChange ~ HealthStat)
summary(model)
model <- aov(data=DF, formula = FoldChange ~ HealthStat + Gene)
summary(model)
model <- aov(data=DF, formula = FoldChange ~ HealthStat * Gene)
summary(model)
model <- aov(data=DF, formula = (FoldChange ~ HealthStat) * Gene)
model <- aov(data=DF, formula = FoldChange ~ HealthStat / Gene)
summary(model)
model <- aov(data=DF, formula = FoldChange ~ HealthStat; Gene)
model <- aov(data=DF, formula = FoldChange ~ HealthStat: Gene)
summary(model)
model <- aov(data=DF, formula = FoldChange ~ HealthStat - Gene)
summary(model)
model <- lm(data=DF, formula = FoldChange ~ HealthStat)
summary(model)
HealthStat <- rep(c("Sick","Sick","Healthy","Sick","Healthy","Healthy","Sick","Sick","Healthy","Sick","Healthy","Healthy","Sick","Sick","Healthy","Sick","Healthy","Healthy","Sick","Healthy"),2)
ID <- rep(1:20, 2)
Location <- rep(c("I", "O", "I", "O", "O", "I", "O", "I", "O", "I"), 4)
FoldChange <- rnorm(40, mean = 0, sd = 2)
FoldChangeBack <- rnorm(40, mean = 0, sd = 2)
Gene <- c(rep("Gene1", 20), rep("Gene2", 20))
DF <- data.frame(ID, Gene, HealthStat, Loation, FoldChange, FoldChangeBack)
DF <- data.frame(ID, Gene, HealthStat, Location, FoldChange, FoldChangeBack)
DF1 <- ddply(DF, c("HealthStat", "Gene"), summarise,
n = length(FoldChange),
mean = mean(FoldChange, na.rm=TRUE),
sd = sd(FoldChange, na.rm=TRUE),
se = sd / sqrt(n))
meanCI <- mean(DF$FoldChangeBack)
n <- length(DF$FoldChangeBack)
s <- sd(DF$FoldChangeBack)
MOE <- qnorm(0.975)*s/sqrt(n)
upper <- meanCI + MOE
lower <- meanCI - MOE
colors <- c("slategray3", "dodgerblue4")
plot1 <- ggplot(DF1, aes(x=Gene,
y=mean,
fill=HealthStat)) +
geom_bar(stat="identity",
color = "black",
position=position_dodge()) + labs(x="Gene", y = "log(Fold Change)") + geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width=.2, position=position_dodge(.9))
plot1 + theme_minimal(base_size = 17) + scale_fill_manual(values=colors, name="Health Status:") + theme(legend.position=c(.2, .85)) + coord_cartesian(ylim = c(-2, 2)) + annotate("segment", x = .5, xend = 2.5, y = meanCI, yend = meanCI, col = "red") + annotate("segment", x = .5, xend = 2.5, y = upper, yend = upper, col = "red", linetype = 2, size = 0.3) + annotate("segment", x = .5, xend = 2.5, y = lower, yend = lower, col = "red", linetype = 2, size = 0.3)
DF1 <- ddply(DF, c("HealthStat", "Gene"), summarise,
n = length(FoldChange),
mean = mean(FoldChange, na.rm=TRUE),
sd = sd(FoldChange, na.rm=TRUE),
se = sd / sqrt(n))
HealthStat <- rep(c("Sick","Sick","Healthy","Sick","Healthy","Healthy","Sick","Sick","Healthy","Sick","Healthy","Healthy","Sick","Sick","Healthy","Sick","Healthy","Healthy","Sick","Healthy"),2)
ID <- rep(1:20, 2)
Location <- rep(c("I", "O", "I", "O", "O", "I", "O", "I", "O", "I"), 4)
FoldChange <- rnorm(40, mean = 0, sd = 2)
FoldChangeBack <- rnorm(40, mean = 0, sd = 2)
Gene <- c(rep("Gene1", 20), rep("Gene2", 20))
DF <- data.frame(ID, Gene, HealthStat, Location, FoldChange, FoldChangeBack)
DF1 <- ddply(DF, c("HealthStat", "Gene"), summarise,
n = length(FoldChange),
mean = mean(FoldChange, na.rm=TRUE),
sd = sd(FoldChange, na.rm=TRUE),
se = sd / sqrt(n))
meanCI <- mean(DF$FoldChangeBack)
n <- length(DF$FoldChangeBack)
s <- sd(DF$FoldChangeBack)
MOE <- qnorm(0.975)*s/sqrt(n)
upper <- meanCI + MOE
lower <- meanCI - MOE
colors <- c("slategray3", "dodgerblue4")
plot1 <- ggplot(DF1, aes(x=Gene,
y=mean,
fill=HealthStat)) +
geom_bar(stat="identity",
color = "black",
position=position_dodge()) + labs(x="Gene", y = "log(Fold Change)") + geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width=.2, position=position_dodge(.9))
plot1 + theme_minimal(base_size = 17) + scale_fill_manual(values=colors, name="Health Status:") + theme(legend.position=c(.2, .85)) + coord_cartesian(ylim = c(-2, 2)) + annotate("segment", x = .5, xend = 2.5, y = meanCI, yend = meanCI, col = "red") + annotate("segment", x = .5, xend = 2.5, y = upper, yend = upper, col = "red", linetype = 2, size = 0.3) + annotate("segment", x = .5, xend = 2.5, y = lower, yend = lower, col = "red", linetype = 2, size = 0.3)
head(DF)
mod2 <- glmer(data=DF, formula = FoldChange ~ HealthStat + (1|ID) + (1|Location), family = gaussian)
library(lme4)
mod2 <- glmer(data=DF, formula = FoldChange ~ HealthStat + (1|ID) + (1|Location), family = gaussian)
summary(BQCVmod)
summary(mod2)
head(DF)
model <- aov(data=DF, formula = FoldChange ~ HealthStat)
summary(model)
library(lme4)
mod2 <- lmer(data=DF, formula = FoldChange ~ HealthStat + (1|ID) + (1|Location))
summary(mod2)
nullMod <- lmer(data=DF, formula = FoldChange ~ 1 + (1|ID) + (1|Location))
fullMod <- lmer(data=DF, formula = FoldChange ~ HealthStat + (1|ID) + (1|Location))
anova(nullMod, fullMod)
nullMod <- lmer(data=DF, formula = FoldChange ~ 1 + (1|ID) + (1|Location), REML = FALSE)
fullMod <- lmer(data=DF, formula = FoldChange ~ HealthStat + (1|ID) + (1|Location), REML = FALSE)
anova(nullMod, fullMod)
splitDF <- split(DF, DF$Gene)
splitDF$Gene1
nullMod <- lmer(data=splitDF$Gene1, formula = FoldChange ~ 1 + (1|ID) + (1|Location), REML = FALSE)
nullMod <- lmer(data=splitDF$Gene1, formula = FoldChange ~ 1 + (1|ID) + (1|Location), REML = FALSE)
fullMod <- lmer(data=splitDF$Gene1, formula = FoldChange ~ HealthStat + (1|ID) + (1|Location), REML = FALSE)
splitDF
plot6 <- ggplot(DF, aes(Mass, fill=Origin))
library(ggplot2)
library(plyr)
ID <- c(1:200)
Origin <- c(rep("local", 100),
rep("California", 100))
FlowerType <- rep(c(rep("clover",25),
rep("goldenrod",25),
rep("treefoil",25),
rep("mixed",25)),2)
Mass <- c(rnorm(n = 100,
mean=32,
sd = 8), rnorm(n = 100,
mean=21,
sd=4))
NosemaLoad <-c(rnorm(n = 100,
mean=100000,
sd = 80000), rnorm(n = 100,
mean=500000,
sd=40000))
VarroaLoad <- c(rnorm(n = 100,
mean=5,
sd = 2), rnorm(n = 100,
mean=9,
sd=3))
Time <- rep(c(rep("Time1", 50), rep("Time2", 50)),2)
DF <- data.frame(ID, Origin, FlowerType, Mass, NosemaLoad, VarroaLoad, Time)
plot6 <- ggplot(DF, aes(Mass, fill=Origin))
plot6 + geom_histogram(alpha=0.2) + stat_bin(bins = 30) + theme_minimal(base_size = 17) + scale_fill_manual(values=colors)
plot6 <- ggplot(DF, aes(Mass, fill=Origin, alpha=0.2))
plot6 + geom_histogram() + stat_bin(bins = 30) + theme_minimal(base_size = 17) + scale_fill_manual(values=colors)
plot6 <- ggplot(DF, aes(Mass))
plot6 + geom_histogram(fill=Origin, alpha=0.2) + stat_bin(bins = 30) + theme_minimal(base_size = 17) + scale_fill_manual(values=colors)
plot6 <- ggplot(DF, aes(Mass))
plot6 + geom_histogram(data=subset(DF, Origin == "Local"), fill = "slategray3", alpha = 0.4) + geom_histogram(data=subset(DF, Origin == "California"), fill = "dodgerblue4", alpha = 0.4) + stat_bin(bins = 30) + theme_minimal(base_size = 17) + scale_fill_manual(values=colors)
plot6 <- ggplot(DF, aes(Mass)) + geom_histogram(data=subset(DF, Origin == "Local"), fill = "slategray3", alpha = 0.4) + geom_histogram(data=subset(DF, Origin == "California"), fill = "dodgerblue4", alpha = 0.4)
plot6 + stat_bin(bins = 30) + theme_minimal(base_size = 17) + scale_fill_manual(values=colors)
subset(DF, Origin == "California")
plot6 <- ggplot(DF, aes(Mass, fill=Origin, alpha=0.2))
plot6 + geom_histogram() + stat_bin(bins = 30) + theme_minimal(base_size = 17) + scale_fill_manual(values=colors)
plot6 <- ggplot(DF, aes(Mass, fill=Origin))
plot6 + geom_histogram(alpha=0.2, position="identity") + stat_bin(bins = 30) + theme_minimal(base_size = 17) + scale_fill_manual(values=colors)
plot6 <- ggplot(DF, aes(Mass, fill=Origin))
+ geom_histogram(alpha=0.2, position="identity")
plot6 <- ggplot(DF, aes(Mass, fill=Origin)) +
geom_histogram(alpha=0.2, position="identity")
plot6 + stat_bin(bins = 30) + theme_minimal(base_size = 17) + scale_fill_manual(values=colors)
plot6 <- ggplot(DF, aes(Mass, fill=Origin)) +
geom_histogram(alpha=0.8, position="identity")
plot6 + stat_bin(bins = 30) + theme_minimal(base_size = 17) + scale_fill_manual(values=colors)
plot6 <- ggplot(DF, aes(Mass, fill=Origin)) +
geom_histogram(alpha=0.2, position="identity")
plot6 + stat_bin(bins = 30) + theme_minimal(base_size = 17)
plot6 <- ggplot(DF, aes(Mass, fill=Origin)) +
geom_histogram(alpha=0.2, position="identity") +
stat_bin(bins = 30)
plot6 <- ggplot(DF, aes(Mass, fill=Origin)) +
geom_histogram(alpha=0.2, position="identity") +
stat_bin(bins = 30)
plot6
plot6 <- ggplot(DF, aes(Mass, fill=Origin)) +
geom_histogram(alpha=0.2)
plot6 + stat_bin(bins = 30) + theme_minimal(base_size = 17)
plot6 <- ggplot(DF, aes(Mass, fill=Origin)) +
geom_histogram(alpha=0.2, position="identity")
plot6 + stat_bin(bins = 30) + theme_minimal(base_size = 17) + scale_fill_manual(values=colors)
plot6 <- ggplot(DF, aes(Mass, fill=Origin)) +
geom_histogram(alpha=0.2, aes(y = ..density..), position="identity")
plot6 + stat_bin(bins = 30) + theme_minimal(base_size = 17) + scale_fill_manual(values=colors)
Concentration <- c(rep("20%", 10), rep("10%", 10))
Concentration
Refractometer <- rep(c(rep("New", 5), rep("Old", 5)),2)
Refractometer
data <- data.frame(Refractometer, Concentration, RefReading)
RefReading <- c(12.5,12.5,12.5,12.5,12.5,10,10,10,10,10,21,21,22,21,21,18,19,19,19,19)
data <- data.frame(Refractometer, Concentration, RefReading)
data
Concentration <- c(rep("10%", 10), rep("20%", 10))
Refractometer <- rep(c(rep("New", 5), rep("Old", 5)),2)
RefReading <- c(12.5,12.5,12.5,12.5,12.5,10,10,10,10,10,21,21,22,21,21,18,19,19,19,19)
data <- data.frame(Refractometer, Concentration, RefReading)
data
Trial <- rep(c(1:5),4)
Concentration <- c(rep("10%", 10), rep("20%", 10))
Refractometer <- rep(c(rep("New", 5), rep("Old", 5)),2)
RefReading <- c(12.5,12.5,12.5,12.5,12.5,10,10,10,10,10,21,21,22,21,21,18,19,19,19,19)
data <- data.frame(Trial, Refractometer, Concentration, RefReading)
data
str(data)
mod <- aov(data, RefReading~Concentration + Refractometer)
mod <- aov(data = data, RefReading~Concentration + Refractometer)
summary(mod)
splitDat <- split(data, data$Concentration)
mod <- aov(splitDat$`20%`$Concentration~splitDat$`20%`$Refractometer)
mod <- aov(splitDat$20%$Concentration~splitDat$20%$Refractometer)
Trial <- rep(c(1:5),4)
Concentration <- c(rep("10", 10), rep("20", 10))
Refractometer <- rep(c(rep("New", 5), rep("Old", 5)),2)
RefReading <- c(12.5,12.5,12.5,12.5,12.5,10,10,10,10,10,21,21,22,21,21,18,19,19,19,19)
data <- data.frame(Trial, Refractometer, Concentration, RefReading)
mod <- aov(data = data, RefReading~Concentration + Refractometer)
summary(mod)
splitDat <- split(data, data$Concentration)
mod <- aov(splitDat$20$Concentration~splitDat$20$Refractometer)
mod <- aov(splitDat$`20%`$Concentration~splitDat$`20%`$Refractometer)
mod <- aov(splitDat$`20%`$Concentration~splitDat$`20%`$Refractometer, data = splitDat$`20`)
mod <- aov(splitDat$`20%`$Concentration~splitDat$`20%`$Refractometer, data = splitDat$`20`)
mod <- aov(splitDat$`20%`$Concentration~splitDat$`20%`$Refractometer)
mod <- aov(splitDat$`20%`$Concentration~splitDat$`20%`$Refractometer)
mod <- aov(splitDat$`20%`$Concentration~splitDat$`20%`$Refractometer)
splitDat <- split(data, data$Concentration)
mod <- aov(splitDat$`20%`$Concentration~splitDat$`20%`$Refractometer)
Concentration <- c(rep("Ten", 10), rep("Twenty", 10))
Refractometer <- rep(c(rep("New", 5), rep("Old", 5)),2)
RefReading <- c(12.5,12.5,12.5,12.5,12.5,10,10,10,10,10,21,21,22,21,21,18,19,19,19,19)
data <- data.frame(Trial, Refractometer, Concentration, RefReading)
mod <- aov(data = data, RefReading~Concentration + Refractometer)
summary(mod)
splitDat <- split(data, data$Concentration)
mod <- aov(splitDat$Twenty$Concentration~splitDat$Twenty$Refractometer)
summary(mod)
summary(mod)
mod <- aov(splitDat$Twenty$RefReading~splitDat$Twenty$Refractometer)
summary(mod)
mod10 <- aov(splitDat$Ten$RefReading~splitDat$Ten$Refractometer)
summary(mod10)
splitDatConc <- split(data, data$Refractometer)
splitDatConc$New - splitDatConc$Old
splitDatConc$New$RefReading - splitDatConc$Old$RefReading
splitDatConc$New$RefReading
reading <- splitDatConc$New$RefReading - splitDatConc$Old$RefReading
conc <- c(rep("Ten",5), rep("Twenty",5))
df <- data.frame(conc, reading)
df
m <- aov(data=df, reading~conc)
summary(m)
mean(reading)
# required packages:
library(plyr)
library(dplyr)
install.packages(plyr)
install.packages("plyr")
# required packages:
library(plyr)
install.packages("ggplot2")
install.packages("dplyr")
install.packages("lme4")
install.packages("car")
install.packages("MASS")
install.packages("vegan")
install.packages("factoextra")
install.packages("knitr")
install.packages("knitr")
library(knitr)
# required packages:
library(plyr)
library(ggplot2)
library(dplyr)
library(lme4)
library(car)
library(MASS)
library(vegan)
library(factoextra)
# Preliminaries:
# Clear memory of characters:
rm(list=ls())
# Set Working Directory:
setwd("~/AlgerProjects/MigratoryStationary/")
# Read in Nosema/Varroa/Eco Data:
MigStat <- read.table("Data/MigStatClean.csv",
header=TRUE,
sep = ",",
stringsAsFactors = FALSE)
MigStat$Treatment <- ifelse(MigStat$Treatment=="Stationary","Stationary\n(Isolated)", ifelse(MigStat$Treatment=="Migratory", "Migratory", "Exposed"))
MigStat$NosemaLoadRecount1 <- ((MigStat$NosemaLoadRecount*4000000)/80)/100000
# required packages:
library(plyr)
library(ggplot2)
library(dplyr)
library(lme4)
library(car)
library(MASS)
library(cowplot)
# Setting up dataframe without Exposed for Experiment 1 data (Mig vs Stationary)
MigStatExp_1<-MigStat[!(MigStat$Treatment=="Exposed"),]
# Summary of DWV prev. for experiment 1
VirusSum2 <- ddply(MigStat, c("Treatment", "SamplingEvent"), summarise,
n = length(logDWV),
mean = mean(logDWV, na.rm=TRUE),
sd = sd(logDWV, na.rm = TRUE),
se = sd / sqrt(n))
# plotting DWV prev. for experiment 1
DWVload1 <- ggplot(data = VirusSum2,
aes(x = SamplingEvent,
y = mean,
group = Treatment)
) + geom_point(size=4) + labs(x = NULL, y = "DWV log(genome copies/bee)") + coord_cartesian(ylim = c(0, 15), xlim = c(1,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05)) + geom_line(aes(linetype=Treatment), size=1.5) + scale_fill_brewer(palette = "Paired") + theme_classic(base_size = 17) + theme(legend.position = "none") + labs(linetype="Operation Type:") + scale_x_continuous(breaks=c(1,2,3))
DWVload1
treatment <- <- c(rep("A",5), rep("B", 5), rep("C", 5), rep("D",5))
treatment <- c(rep("A",5), rep("B", 5), rep("C", 5), rep("D",5))
survivorship <- c(1,1,0,0,0,1,1,1,1,0,1,0,1,1,0,0,0,0,1)
length(survivorship)
season <- rep(c("S","S","S","W","W","W"),4)
season
survivorship <- c(1,1,0,1,1,0,0,1,1,0,01,1,0,1,0,1,1,0,0,1,0,0,1)
treatment <- c(rep("A",6), rep("B", 6), rep("C", 6), rep("D",6))
season <- rep(c("S","S","S","W","W","W"),4)
ID <- c(1:24)
ID
data <- data.frame(ID, survivorship,treatment,season)
survivorship <- c(1,1,0,1,1,0,0,1,1,0,01,1,0,1,0,1,1,0,0,1,0,0,1)
length(survivorship)
data <- data.frame(ID, survivorship,treatment,season)
ID <- c(1:24)
survivorship <- c(1,1,0,1,1,0,1,0,1,1,0,01,1,0,1,0,1,1,0,0,1,0,0,1)
treatment <- c(rep("A",6), rep("B", 6), rep("C", 6), rep("D",6))
season <- rep(c("S","S","S","W","W","W"),4)
data <- data.frame(ID, survivorship,treatment,season)
data
data$death <- ifese(data=data, survivorship==1,0,1)
data$death <- ifelse(data=data, survivorship==1,0,1)
data$death <- ifelse(data$survivorship==1,0,1)
death
data$death
plot(data$death, data$survivorship)
data$survivorship
library(dply)
library(ddply)
library(plyr)
# Summary of DWV prev. for experiment 1
death <- ddply(MigStatExp_1, c("treatment", "season"), summarise,
n = length(death),
mean = mean(death, na.rm=TRUE),
sd = sd(death, na.rm = TRUE),
se = sd / sqrt(n))
# Summary of DWV prev. for experiment 1
death <- ddply(data, c("treatment", "season"), summarise,
n = length(death),
mean = mean(death, na.rm=TRUE),
sd = sd(death, na.rm = TRUE),
se = sd / sqrt(n))
death
library(ggplot2)
library(ggplot2)
ggplot(data = death,
aes(x = treatment,
y = mean,
fill = season)
) + geom_bar() + labs(x = "Sampling Event", y = "DWV log(genome copies/bee)") + coord_cartesian(ylim = c(0, 15), xlim = c(1,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05)) + theme_minimal(base_size = 17) + theme(legend.position=c(.2, .85))
ggplot(data = death,
aes(x = treatment,
fill = season)
) + geom_bar() + labs(x = "Sampling Event", y = "DWV log(genome copies/bee)") + coord_cartesian(ylim = c(0, 15), xlim = c(1,3)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05)) + theme_minimal(base_size = 17) + theme(legend.position=c(.2, .85))
ggplot(data = death,
aes(x = treatment,
fill = season)
) + geom_bar() + labs(x = "Sampling Event", y = "DWV log(genome copies/bee)") + coord_cartesian(ylim = c(0, 6)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.05)) + theme_minimal(base_size = 17) + theme(legend.position=c(.2, .85))
ggplot(data = death,
aes(treatment, mean,
fill = season)
) + geom_bar() + labs(x = "Sampling Event", y = "DWV log(genome copies/bee)") + coord_cartesian(ylim = c(0, 6)) + theme_minimal(base_size = 17) + theme(legend.position=c(.2, .85))
ggplot(data = death,
aes(treatment, mean,
fill = season)
) + geom_bar(position = "fill", stat = "identity") + labs(x = "Sampling Event", y = "DWV log(genome copies/bee)") + coord_cartesian(ylim = c(0, 6)) + theme_minimal(base_size = 17) + theme(legend.position=c(.2, .85))
ggplot(data = death,
aes(treatment, mean,
fill = season)
) + geom_bar(position = "fill", stat = "identity") + labs(x = "Sampling Event", y = "DWV log(genome copies/bee)") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position=c(.2, .85))
library(scales)
ggplot(data = death,
aes(treatment, mean,
fill = season)
) + geom_bar(position = "fill", stat = "identity") + labs(x = "Sampling Event", y = "DWV log(genome copies/bee)") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position=c(.2, .85)) + scale_y_continuous(labels = percent)
ggplot(data = death,
aes(treatment, mean,
fill = season)
) + geom_bar(position = "fill", stat = "identity") + labs(x = "Treatment", y = "Percent Dead") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position=c(.2, .85)) + scale_y_continuous(labels = percent)
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season)
) + geom_bar(position = "fill", stat = "identity", fill=season) + labs(x = "Treatment", y = "Percent Dead") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position=c(.2, .85)) + scale_y_continuous(labels = percent)
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season)
) + geom_bar(position = "fill", stat = "identity") + labs(x = "Treatment", y = "Percent Dead") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position=c(.2, .85)) + scale_y_continuous(labels = percent)
death
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season, label=mean)
) + geom_bar(position = "fill", stat = "identity") + labs(x = "Treatment", y = "Percent Dead") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position=c(.2, .85)) + scale_y_continuous(labels = percent)
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season, label=mean)
) + geom_bar(stat = "identity") + labs(x = "Treatment", y = "Percent Dead") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position=c(.2, .85)) + scale_y_continuous(labels = percent)
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season, label=mean)
) + geom_bar(stat = "identity") + labs(x = "Treatment", y = "Percent Dead") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position="top") + scale_y_continuous(labels = percent)
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season)
) + geom_bar(stat = "identity") + labs(x = "Treatment", y = "Percent Dead") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position="top") + scale_y_continuous(labels = percent)
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season)
) + geom_bar(stat = "identity") + labs(x = "Treatment", y = "Percent Losses") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position="top") + scale_y_continuous(labels = percent)
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season)
) + geom_bar(stat = "identity") + labs(x = "Treatment", y = "Percent Losses") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position="top") + scale_y_continuous(labels = percent) + scale_fill_manual(fill=c("blue", "slategrey"))
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season)
) + geom_bar(stat = "identity") + labs(x = "Treatment", y = "Percent Losses") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position="top") + scale_y_continuous(labels = percent) + scale_fill_manual(fill=c("blue", "slategray"))
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season)
) + geom_bar(stat = "identity") + labs(x = "Treatment", y = "Percent Losses") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position="top") + scale_y_continuous(labels = percent) + scale_fill_manual(color=c("blue", "green"))
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season)
) + geom_bar(stat = "identity") + labs(x = "Treatment", y = "Percent Losses") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position="top") + scale_y_continuous(labels = percent) + scale_fill_manual(values=c("blue", "green"))
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season)
) + geom_bar(stat = "identity") + labs(x = "Treatment", y = "Percent Losses") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position="top") + scale_y_continuous(labels = percent) + scale_fill_manual(values=c("slategrey", "blue"))
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season)
) + geom_bar(stat = "identity") + labs(x = "Treatment", y = "Percent Losses") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position="top") + scale_y_continuous(labels = percent) + scale_fill_manual(values=c("slategrey", "steelblue"))
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season)
) + geom_bar(stat = "identity") + labs(x = "Treatment", y = "Percent Losses") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position="top") + scale_y_continuous(labels = percent) + scale_fill_manual(values=c("grey", "steelblue"))
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season)
) + geom_bar(stat = "identity") + labs(x = "Treatment", y = "Percent Losses") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position="top") + scale_y_continuous(labels = percent) + scale_fill_manual(values=c("grey4", "steelblue"))
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season)
) + geom_bar(stat = "identity") + labs(x = "Treatment", y = "Percent Losses") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position="top") + scale_y_continuous(labels = percent) + scale_fill_manual(values=c("grey20", "steelblue"))
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season)
) + geom_bar(stat = "identity") + labs(x = "Treatment", y = "Percent Losses") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position="top") + scale_y_continuous(labels = percent) + scale_fill_manual(values=c("lightgrey", "steelblue"))
ggplot(data = death,
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season)
) + geom_bar(stat = "identity") + labs(x = "Treatment", y = "Percent Losses") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position="top") + scale_y_continuous(labels = percent) + scale_fill_manual(values=c("goldenrod", "steelblue"))
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season)
) + geom_bar(stat = "identity") + labs(x = "Treatment", y = "Percent Losses") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position="top") + scale_y_continuous(labels = percent) + scale_fill_manual(values=c("goldenrod", "steelblue"))
ggplot(data = death,
aes(x=treatment, y=mean,
fill = season)
) + geom_bar(stat = "identity") + labs(x = "Treatment", y = "Percent Losses") + coord_cartesian(ylim = c(0, 1)) + theme_minimal(base_size = 17) + theme(legend.position="top") + scale_y_continuous(labels = percent) + scale_fill_manual(values=c("goldenrod", "steelblue"))
