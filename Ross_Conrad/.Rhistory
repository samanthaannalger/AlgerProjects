y1=1*exp(.15*x1)
plot(x1,y1)
x1=seq(0,16)
y1=seq(0,16)
y1=1*exp(.15*x1)
plot(x1,y1)
# Samantha Alger
# November 13th 2014
##honeybee abundance
honeybee.abun<-rpois(n=10000,lambda = 3)
hist(honeybee.abun, main="Honeybee Abundance",xlab= expression(paste("honeybees/m"^"2")))
#Subsample the distribution for honeybee abundance surveys at 15 sites.
honeybee.abun<-sample(honeybee.abun, 300, replace=FALSE, prob=NULL)
hist(sub.sample, main = "Honey bee abundance n=15",breaks=8, col="goldenrod", xlab=expression(paste("honeybees/m"^"2")))
#honeybee viral load:
honeybee.viral.load = rbeta(n=10000, shape1 =3, shape2 =2) *12+0
hist(honeybee.viral.load,main="Honeybee viral load", xlab= "# copies of viral genome/bee",breaks=50,col="goldenrod")
#Subsample honeybee viral load for 300 bees:
hbViralLoad<-sample(honeybee.viral.load, 300, replace=FALSE, prob=NULL)
hist(sub.sample, main= "Honey bee virus load n=300", breaks=20, col="goldenrod",xlab= "# copies of viral genome/bee")
#Bumble bee viral load:
library(truncnorm)
mu1 <- 9.7 #0
mu2 <- 0 #1600
sig1 <- 2.6 #190
sig2 <- 2.5 #300
cpct <- 0.6
bimodalDistFunc <- function (n,cpct, mu1, mu2, sig1, sig2) {
y0 <- rtruncnorm(n, a=0, mean = mu1, sd = sig1)
y1 <- rtruncnorm(n, a=0, b=4000, mean = mu2, sd = sig2)
flag <- rbinom(n, size=1, prob=cpct)
y <- y0*(1 - flag) + y1*flag
}
bimodalData <- bimodalDistFunc(n=100000, cpct, mu1, mu2, sig1, sig2)
hist(bimodalData, main="Bumblebee viral load", xlab="# copies of virus genome/bee",breaks=50, col="goldenrod")
#Create a sub sample of the distribution to show
BViralLoad<- sample(bimodalData,300,replace=FALSE, prob=NULL)
#view the subsample
hist(sub.sample, main="Bumble bee virus load n=300", breaks=20,col="goldenrod", xlab="# copies of virus genome/bee")
summary(BViralLoad)
#What is the error for bumble bee viral load?
sd(BViralLoad) #4.43
#create a distribution of error
error<-rnorm(n=300,mean=0,sd=1)
#create a matrix
data<-matrix(data=NA, nrow=300, ncol=6)
#assign column names
colnames(data)<-c("BVirus", "HBVirus", "HBabun", "Error", "HBVirus_Y", "HBabun_Y")
#populate column two with honeybee viral load data
data[,2]=hbViralLoad
#populate error column
data[,4]=error
#population honeybee abundance data
data[,3]=honeybee.abun
#View the data thus far
View(data)
##########################################################################
#Fitting data model:
x=data[,2] #honeybee viral load
y=NULL #bumble bee viral load
a=15 #6
b=.25
e=exp(1)
#for (x in 1:300) {
data[,5]=a*(1-(e^(-b*(data[,2])))) #to find y given HB viral load (natural growth model
data[,6] =1*exp(.15*(data[,3])) #to find y given honeybee abundance
abundance<-plot((data[,5]),(data[,3])) #plotting the honeybee abundance data and bViral loads
data[,1]=(data[,5])+(data[,4]) #calculating Y with error, only taking hb viral load into account.
data[,5]=a*(1-(e^(-b*(data[,2])))) #to find y given HB viral load (natural growth model
data[,6] =1*exp(.15*(data[,3])) #to find y given honeybee abundance
abundance<-plot((data[,5]),(data[,3])) #plotting the honeybee abundance data and bViral loads
data[,1]=(data[,4]) + ((data[,5]/2)+(data[,6]/2))
View(data)
mydata<-plot((data[,1]),(data[,2]), xlab="honeybee viral load", ylab="bumblebee viral load")
BV<-data[,1]
HB<-data[,2]
#non-linear model testing:
mod1<-nls(BV~(a*(1-(e^(-b*(HB))))), start=c(b = .25,a = 15))
summary(mod1)
mod1<-nls(BV~(a*(1-(e^(-b*(HB))))), start=list(b = .25,a = 15))
summary(mod1)
require(isectpolyrst)
??isectpolyrst
install.packages("isectpolyrst")
rm(list= ls(all=TRUE))
rnorm(mean=1, sd=.5, data=1000)
rnorm(mean=1, sd=.5, n=1000)
lambda<-rnorm(mean=1, sd=.5, n=1000)
hist(lambda)
#Create a matrix
PVA<-matrix(data=NA, nrow=100, ncol=3)
#assign column names
colnames(PVA)<-c("PopSize", "Lambda")
PVA<-matrix(data=NA, nrow=100, ncol=2)
#assign column names
colnames(PVA)<-c("PopSize", "Lambda")
attach(PVA)
head(PVA)
Lambda_Sub_Sample<-sample(lambda, 100, replace=FALSE, prob=NULL)
head(Lambda_Sub_Sample)
PVA[,2]=Lambda_Sub_Sample
head(PVA)
lambda<-rnorm(mean=1, sd=.5, n=1000, lbound=0)
lambda<-rnorm(mean=1, sd=.5, n=1000, min=0)
Lambda_Sub_Sample<-sample(lambda, 100, replace=FALSE, prob=NULL, min=0)
Lambda_Sub_Sample<-sample(lambda, 100, replace=FALSE, prob=NULL, lbound=0)
hist(lambda)=3
hist(lambda)+3
honeybee.viral.load = rbeta(n=10000, shape1 =3, shape2 =2) *12+0
hist(honeybee.viral.load)
lambda<-rbeta(n=10000, shape1 =3, shape2 =2) *2+0
hist(lambda)
PVA<-matrix(data=NA, nrow=100, ncol=2)
#assign column names
colnames(PVA)<-c("PopSize", "Lambda")
head(PVA)
#Subsample the distribution and input into the matrix
Lambda_Sub_Sample<-sample(lambda, 100, replace=FALSE, prob=NULL)
head(Lambda_Sub_Sample)
#add values to column
PVA[,2]=Lambda_Sub_Sample
head(PVA)
#set starting population
PVA[1,1]=1000
head(PVA_)
head(PVA)
34.21-13.79
71.50-25
67.00-.09-2-2-5.29-5.72
52.90+19.48+22.10+11.98+11.40+20.42+46.50+139.55+9.50
206+440+333.83
979.83+15.77
#barplot of vial load by colony number
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
ls()
rm(list=ls())
library(dplyr)
# Set Working Directory:
setwd("~/Desktop/RScripts/Ross_Conrad")
# read in data:
ConradDF <- read.table("ConradDF.csv", header=TRUE, sep = ",")
```
```{r,  echo=FALSE}
ls()
rm(list=ls())
library(dplyr)
# Set Working Directory:
setwd("~/Desktop/RScripts/Ross_Conrad")
# read in data:
ConradDF <- read.table("ConradDF.csv", header=TRUE, sep = ",")
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
#barplot of vial load by colony number
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2,
ann = FALSE
)
of vial load by colony number
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
#ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2,
ann = FALSE
)
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
#ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2,
ann = FALSE
)
mtext(side = 2, text = "Y Axis", line = 3)
#barplot of vial load by colony number
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
#ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2,
ann = FALSE
)
mtext(side = 3, text = "DWV Viral Load (average genome copies per bee)", line = 3, font.lab=2)
#barplot of vial load by colony number
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
#ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2,
ann = FALSE
)
mtext(side = 2, text = "DWV Viral Load (average genome copies per bee)", line = 3, font.lab=2)
#barplot of vial load by colony number
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
#ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2,
ann = FALSE
)
mtext(side = 2, text = "DWV Viral Load (average genome copies per bee)", line = 4, font.lab=2)
mtext(side = 4, text = "DWV Viral Load (average genome copies per bee)", line = 4, font.lab=2)
```
ConradDF
ConradDF$norm_genome_copbeeBil <- ConradDF$norm_genome_copbee/1000000000
ConradDF$norm_genome_copbeeBil
ConradDF <- read.table("ConradDF.csv", header=TRUE, sep = ",")
ConradDF$norm_genome_copbeeBil <- ConradDF$norm_genome_copbee/1000000
ConradDF$norm_genome_copbeeMil <- ConradDF$norm_genome_copbee/1000000
ConradDF$norm_genome_copbeeMil
ConradDF$norm_genome_copbee_hundthou <- ConradDF$norm_genome_copbee/1000000
ConradDF$norm_genome_copbee_hundthou <- as.integer(ConradDF$norm_genome_copbee/1000000)
ConradDF$norm_genome_copbee_hundthou
ls()
rm(list=ls())
library(dplyr)
# Set Working Directory:
setwd("~/Desktop/RScripts/Ross_Conrad")
# read in data:
ConradDF <- read.table("ConradDF.csv", header=TRUE, sep = ",")
```
```{r,  echo=FALSE}
#barplot of vial load by colony number
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
#ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2,
ann = FALSE
)
#barplot of vial load by colony number
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2,
ann = FALSE
)
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2,
ann = FALSE
)
par(mar = c(6.5, 6.5, 0.5, 0.5), mgp = c(5, 1, 0))
#barplot of vial load by colony number
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2,
ann = FALSE,
par(mar = c(6.5, 6.5, 0.5, 0.5), mgp = c(5, 1, 0)))
#barplot of vial load by colony number
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2,
ann = FALSE,
par(mar = c(6.5, 6.5, 0.5, 0.5)))
par(mar = c(6.5, 6.5, 0.5, 0.5), mgp = c(5, 1, 0))
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
par(mar = c(6.5, 6.5, 0.5, 0.5), mgp = c(5, 1, 0))
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
par(mar = c(6.5, 6.5, 0.5, 0.5), mgp = c(5, 1, 0))
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
par(mar = c(6, 6, 2, 0.5), mgp = c(5, 1, 0))
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
par(mar = c(6, 4, 2, 0.5), mgp = c(5, 1, 0))
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
par(mar = c(6, 6, 2, 0.5), mgp = c(5, 1, 0))
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
par(mar = c(5, 5, 3, 0.5), mgp = c(5, 1, 0))
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
par(mar = c(6, 6, 3, 0.5), mgp = c(5, 1, 0))
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
par(mar = c(6, 6, 3, 1), mgp = c(5, 1, 0))
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
par(mar = c(6, 6, 4, .5), mgp = c(5, 1, 0))
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
par(mar = c(6, 6, 4, .5), mgp = c(5, 1, 0))
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
par(mar = c(6, 6, 4, .5), mgp = c(5, 1, 0))
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
par(mar = c(5, 6, 4, .5), mgp = c(5, 1, 0))
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
```
par(mar = c(6, 6, 4, .5), mgp = c(4, 1, 0))
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
```
par(mar = c(6, 6, 4, .5), mgp = c(4, 2, 0))
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
par(mar = c(6, 6, 4, .5), mgp = c(4, 2, 0))
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
par(mar = c(6, 6, 4, .5), mgp = c(4, 3, 0))
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
```
par(mar = c(6, 6, 4, .5), mgp = c(4, 1, 0))
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
```
barplot(log(ConradDF$norm_genome_copbee),
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
barplot(ConradDF$norm_genome_copbee),
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
barplot(ConradDF$norm_genome_copbee,
names.arg = ConradDF$sample_name,
xlab="Colony ID",
ylab="DWV Viral Load (average genome copies per bee)",
main="Deformed Wing Virus Loads by Colony in Apiary '125'",
col='goldenrod',
font.lab=2,
las=2
)
\usepackage{graphicx}
\includegraphics{ColonyNumber.pdf}
