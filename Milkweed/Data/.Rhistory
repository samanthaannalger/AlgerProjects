BigOrange = sum(BigOrange, na.rm = TRUE),
SmallOrange = sum(SmallOrange, na.rm = TRUE),
Apis = sum(Apis, na.rm = TRUE),
BigBlack = sum(BigBlack, na.rm = TRUE),
SmallBlack = sum(SmallBlack, na.rm = TRUE),
TinyBlack = sum(TinyBlack, na.rm = TRUE),
Green = sum(Green, na.rm = TRUE),
Flies = sum(Flies, na.rm = TRUE))
BeeStats
BeeStats <- ddply(Bees, c("Site"), summarise,
Bombus(Queen) = sum(BigBombus, na.rm = TRUE),
SmallBombus = sum(SmallBombus, na.rm = TRUE),
BigOrange = sum(BigOrange, na.rm = TRUE),
SmallOrange = sum(SmallOrange, na.rm = TRUE),
Apis = sum(Apis, na.rm = TRUE),
BigBlack = sum(BigBlack, na.rm = TRUE),
SmallBlack = sum(SmallBlack, na.rm = TRUE),
TinyBlack = sum(TinyBlack, na.rm = TRUE),
Green = sum(Green, na.rm = TRUE),
Flies = sum(Flies, na.rm = TRUE))
BeeStats <- ddply(Bees, c("Site"), summarise,
Bombus-Queen = sum(BigBombus, na.rm = TRUE),
SmallBombus = sum(SmallBombus, na.rm = TRUE),
BigOrange = sum(BigOrange, na.rm = TRUE),
SmallOrange = sum(SmallOrange, na.rm = TRUE),
Apis = sum(Apis, na.rm = TRUE),
BigBlack = sum(BigBlack, na.rm = TRUE),
SmallBlack = sum(SmallBlack, na.rm = TRUE),
TinyBlack = sum(TinyBlack, na.rm = TRUE),
Green = sum(Green, na.rm = TRUE),
Flies = sum(Flies, na.rm = TRUE))
BeeStats <- ddply(Bees, c("Site"), summarise,
'Bombus-Queen' = sum(BigBombus, na.rm = TRUE),
SmallBombus = sum(SmallBombus, na.rm = TRUE),
BigOrange = sum(BigOrange, na.rm = TRUE),
SmallOrange = sum(SmallOrange, na.rm = TRUE),
Apis = sum(Apis, na.rm = TRUE),
BigBlack = sum(BigBlack, na.rm = TRUE),
SmallBlack = sum(SmallBlack, na.rm = TRUE),
TinyBlack = sum(TinyBlack, na.rm = TRUE),
Green = sum(Green, na.rm = TRUE),
Flies = sum(Flies, na.rm = TRUE))
BeeStats
BeeStats <- ddply(Bees, c("Site"), summarise,
'Bombus-Queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
SmallBombus = sum(SmallBombus, na.rm = TRUE),
BigOrange = sum(BigOrange, na.rm = TRUE),
SmallOrange = sum(SmallOrange, na.rm = TRUE),
Apis = sum(Apis, na.rm = TRUE),
BigBlack = sum(BigBlack, na.rm = TRUE),
SmallBlack = sum(SmallBlack, na.rm = TRUE),
TinyBlack = sum(TinyBlack, na.rm = TRUE),
Green = sum(Green, na.rm = TRUE),
Flies = sum(Flies, na.rm = TRUE))
BeeStats
BeeStats <- ddply(Bees, c("Site"), summarise,
'Bombus-Queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-Worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
SmallOrange = sum(SmallOrange, na.rm = TRUE),
Apis = sum(Apis, na.rm = TRUE),
BigBlack = sum(BigBlack, na.rm = TRUE),
SmallBlack = sum(SmallBlack, na.rm = TRUE),
TinyBlack = sum(TinyBlack, na.rm = TRUE),
Green = sum(Green, na.rm = TRUE),
Flies = sum(Flies, na.rm = TRUE))
BeeStats
BeeStats <- ddply(Bees, c("Site"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
'Apis' = sum(Apis, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE),
'Flies' = sum(Flies, na.rm = TRUE))
BeeStats
BeeStats <- ddply(Bees, c("Site","Flower"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
'Apis' = sum(Apis, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE),
'Flies' = sum(Flies, na.rm = TRUE))
BeeStats
# Convert bee data from wide to long format:
library(tidyr)
head(Bees)
BeeDataLong <- gather(BeeStats, Site, Date, Flower, control:Bombus-queen,factor_key=TRUE)
BeeDataLong <- gather(BeeStats, Site, Date, Flower, control:'Bombus-queen',factor_key=TRUE)
# Convert bee data from wide to long format:
library(tidyr)
BeeStats <- ddply(Bees, c("Site","Flower"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
'Apis' = sum(Apis, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE),
'Flies' = sum(Flies, na.rm = TRUE))
BeeDataLong <- gather(BeeStats, Site, Date, Flower, control:'Bombus-queen',factor_key=TRUE)
BeeDataLong <- gather(Bees, Site, Date, Flower, control:BigBombus, BigOrange, factor_key=TRUE)
# Convert bee data from wide to long format:
library(tidyr)
BeeDataLong <- gather(BeeStats, Site, Date, Flower, 'Bombus-queen':'Flies',factor_key=TRUE)
BeeDataLong
BeeStats <- ddply(Bees, c("Site","Flower"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
'Apis' = sum(Apis, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE),
'Flies' = sum(Flies, na.rm = TRUE))
BeeStats
BeeDataLong <- gather(BeeStats, Site, Flower, 'Bombus-queen':'Flies',factor_key=TRUE)
BeeDataLong
BeeDataLong <- gather(BeeStats, Count, 'Bombus-queen':'Flies',factor_key=TRUE)
BeeDataLong
BeeStats <- ddply(Bees, c("Site","Flower"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
'Apis' = sum(Apis, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE),
'Flies' = sum(Flies, na.rm = TRUE))
library(reshape2)
BeeStats
melt(BeeStats, id.vars = c("Site", "Flower"))
BeeStats <- melt(BeeStats, id.vars = c("Site", "Flower"))
plot1 <- ggplot(BeeStats, aes(x=value, y=variable, fill=Site)) +
geom_bar(stat="identity", color="black",
position=position_dodge()) + labs(y="% plants with virus detected", x="Site Type") + geom_errorbar(aes(ymin = mean - sd, ymax = mean + sd, width = 0.2),position=position_dodge(.9))
plot1
plot1 <- ggplot(BeeStats, aes(x=value, y=variable, fill=Site))
plot1
plot1 <- ggplot(BeeStats, aes(x=variable, y=value, fill=Site))
plot1
plot1 <- ggplot(BeeStats, aes(x=value, y=variable, fill=Site))
plot1
plot1 <- ggplot(BeeStats, aes(x=value, y=variable)) + geom_bar(aes(fill = Site))
plot1
BeeStats <- melt(BeeStats, id.vars = c("Site", "Flower"))
# Clear memory of characters:
ls()
rm(list=ls())
# source my packages
library(plyr)
library(ggplot2)
library(reshape2)
# Set Working Directory:
setwd("~/AlgerProjects/Milkweed/Data")
# read in data:
Monarch <- read.csv("MonarchData.csv", header=TRUE, sep = ",", stringsAsFactors = FALSE)
Bees <- read.csv("BeeSurveyObs.csv", header=TRUE, sep = ",", stringsAsFactors = FALSE)
head(Monarch)
MonarchStats <- ddply(Monarch, c("Site", "Date"), summarise,
egg = sum(Total_Eggs, na.rm = TRUE),
larvae = sum(Total_Larvae, na.rm = TRUE),
adults = sum(TotalAdult, na.rm = TRUE))
MonarchLong <- melt(MonarchStats, id.vars = c("Site", "Date"))
# Convert bee data from wide to long format:
library(tidyr)
BeeStats <- ddply(Bees, c("Site","Flower"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
'Apis' = sum(Apis, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE),
'Flies' = sum(Flies, na.rm = TRUE))
library(reshape2)
BeeStats <- melt(BeeStats, id.vars = c("Site", "Flower"))
#choosing color pallet
colors <- c("white", "grey30")
plot1 <- ggplot(BeeStats, aes(x=value, y=variable)) + geom_bar(aes(fill = Site))
plot1
BeeStats
plot1 <- ggplot(BeeStats, aes(x=value, y=variable, fill = Site)) + geom_bar()
plot1
BeeStatsMW <- BeeStats[ which(BeeStats$Flower=='Milkweed', ]
BeeStatsMW <- BeeStats[ which(BeeStats$Flower=='Milkweed'), ]
#choosing color pallet
colors <- c("white", "grey30")
plot1 <- ggplot(BeeStatsMW, aes(x=value, y=variable, fill = Site))
plot1
plot1 <- ggplot(data=BeeStatsMW, aes(x=value, y=variable, fill = Site)) + geom_bar(stat = 'identity')
plot1
plot1 <- ggplot(data=BeeStatsMW, aes(x=variable, y=value, fill = Site)) + geom_bar(stat = 'identity')
plot1
plot1 <- ggplot(data=BeeStatsMW, aes(x=variable, y=value, fill = Site)) + geom_bar(stat = 'identity', position = 'dodge')
plot1
BeeStatsMW <- BeeStatsMW[ !which(BeeStatsMW$variable=='Flies'), ]
plot1 <- ggplot(data=BeeStatsMW, aes(x=variable, y=value, fill = Site)) + geom_bar(stat = 'identity', position = 'dodge')
plot1
BeeStats <- ddply(Bees, c("Site","Flower"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
'Apis' = sum(Apis, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE))
library(reshape2)
BeeStats <- melt(BeeStats, id.vars = c("Site", "Flower"))
BeeStatsMW <- BeeStats[ which(BeeStats$Flower=='Milkweed'), ]
#choosing color pallet
colors <- c("white", "grey30")
plot1 <- ggplot(data=BeeStatsMW, aes(x=variable, y=value, fill = Site)) + geom_bar(stat = 'identity', position = 'dodge')
plot1
plot1 <- ggplot(data=BeeStatsMW, aes(x=value, y=variable, fill = Site)) + geom_bar(stat = 'identity', position = 'dodge')
plot1
plot1 <- ggplot(data=BeeStatsMW, aes(x=variable, y=value, fill = Site)) + geom_bar(stat = 'identity', position = 'dodge')
plot1
BeeStats <- melt(BeeStats, id.vars = c("Site", "Flower"))
BeeStats <- ddply(Bees, c("Site","Flower"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
'Apis' = sum(Apis, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE))
library(reshape2)
BeeStats <- melt(BeeStats, id.vars = c("Site", "Flower"))
BeeBV <- BeeStats[ which(BeeStats$Site=='Borderview'), ]
#choosing color pallet
colors <- c("white", "grey30")
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1
BeeStats <- ddply(Bees, c("Site","Flower"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
'Apis' = sum(Apis, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE))
library(reshape2)
BeeStats <- melt(BeeStats, id.vars = c("Site", "Flower"))
BeeBV <- BeeStats[ which(BeeStats$Site=='Dewing'), ]
#choosing color pallet
colors <- c("white", "grey30")
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1
BeeBV <- BeeStats[ which(BeeStats$Site=='Dewing'), ]
BeeBV <- BeeStats[ !which(BeeStats$variable=='Apis'), ]
#choosing color pallet
colors <- c("white", "grey30")
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1
BeeStats <- ddply(Bees, c("Site","Flower"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
'Apis' = sum(Apis, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE))
library(reshape2)
BeeStats <- melt(BeeStats, id.vars = c("Site", "Flower"))
BeeBV <- BeeStats[ which(BeeStats$Site=='Dewing'), ]
BeeBV <- BeeStats[ !which(BeeStats$variable=='Apis'), ]
#choosing color pallet
colors <- c("white", "grey30")
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1
BeeStats <- ddply(Bees, c("Site","Flower"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
'Apis' = sum(Apis, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE))
library(reshape2)
BeeStats <- melt(BeeStats, id.vars = c("Site", "Flower"))
BeeBV <- BeeStats[ which(BeeStats$Site=='Dewing'), ]
BeeBV <- BeeBV[ !which(BeeBV$variable=='Apis'), ]
#choosing color pallet
colors <- c("white", "grey30")
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1
BeeStats <- ddply(Bees, c("Site","Flower"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
#'Apis' = sum(Apis, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE))
library(reshape2)
BeeStats <- melt(BeeStats, id.vars = c("Site", "Flower"))
BeeBV <- BeeStats[ which(BeeStats$Site=='Dewing'), ]
#choosing color pallet
colors <- c("white", "grey30")
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1
plot1 + theme_bw(base_size = 23) + scale_fill_manual(values=colors, name="Virus", labels=c("BQCV", "DWV")) + theme(legend.position=c(.86, .8),legend.background = element_rect(color = "black", fill = "white", size = .4, linetype = "solid")) + scale_y_continuous(labels = function(x) paste0(x*100, "%"), limits= c(0,.5)) + annotate(geom = "text", x = 1, y = .39, label = "N = 17",cex = 8) + annotate(geom = "text", x = 2, y = .25, label = "N = 18",cex = 8)
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 23)
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + scale_fill_manual(values=colors)
#choosing color pallet
colors <- c("pink", "grey30")
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + scale_fill_manual(values=colors)
#choosing color pallet
colors <- c("steelblue", "grey30")
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + scale_fill_manual(values=colors)
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "New x label")
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "observations")
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + + theme_bw() + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations")
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw() + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations")
BeeStats <- melt(BeeStats, id.vars = c("Site", "Flower"))
BeeBV <- BeeStats[ which(BeeStats$Site=='Borderview'), ]
BeeStats <- ddply(Bees, c("Site","Flower"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
#'Apis' = sum(Apis, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE))
library(reshape2)
BeeStats <- melt(BeeStats, id.vars = c("Site", "Flower"))
BeeBV <- BeeStats[ which(BeeStats$Site=='Borderview'), ]
#choosing color pallet
colors <- c("steelblue", "grey30")
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw() + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations")
# Figure for bees at Dewing:
BeeDew <- BeeStats[ which(BeeStats$Site=='Dewing'), ]
#choosing color pallet
colors <- c("steelblue", "grey30")
plot1 <- ggplot(data=BeeDew, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw() + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations")
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw() + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations") + ggtitle('Bee Observations-Borderview')
plot1 <- ggplot(data=BeeDew, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw() + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations") + + ggtitle('Dewing')
plot1 <- ggplot(data=BeeDew, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw() + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations") + ggtitle('Dewing')
plot1 <- ggplot(data=BeeDew, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw() + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations") + ggtitle('Bee Observations for Dewing')
#choosing color pallet
colors <- c("steelblue", "grey30")
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw() + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations") + ggtitle('Borderview')
# Figure for bees at Dewing:
BeeDew <- BeeStats[ which(BeeStats$Site=='Dewing'), ]
#choosing color pallet
colors <- c("steelblue", "grey30")
plot1 <- ggplot(data=BeeDew, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw() + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations") + ggtitle('Dewing')
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 23) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations") + ggtitle('Borderview')
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations") + ggtitle('Borderview')
plot1 <- ggplot(data=BeeDew, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations") + ggtitle('Dewing')
BeeStats <- ddply(Bees, c("Site","Flower"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
#'Apis' = sum(Apis, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE))
BeeStats
BeeStats <- ddply(Bees, c("Site","Flower"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
'Apis' = sum(Apis, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE),
'Flies' = sum(Flies, na.rm = TRUE))
BeeStats
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations") + ggtitle('Borderview') + scale_y_continuous(formatter='log10')
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations") + ggtitle('Borderview') + scale_y_continuous(formatter='log10')
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower, log10="y")) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations") + ggtitle('Borderview')
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower) , log10="y") + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations") + ggtitle('Borderview')
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=value, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations") + ggtitle('Borderview') + scale_y_continuous(trans = 'log10')
BeeStats <- ddply(Bees, c("Site","Flower"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
#   'Apis' = sum(Apis, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE))
BeeStats
BeeStats <- melt(BeeStats, id.vars = c("Site", "Flower"))
BeeStats$logValue <- log10(BeeStats$value + 1)
# Figure for bees at Borderview:
BeeBV <- BeeStats[ which(BeeStats$Site=='Borderview'), ]
#choosing color pallet
colors <- c("steelblue", "grey30")
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=logValue, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations") + ggtitle('Borderview')
# Figure for bees at Dewing:
BeeDew <- BeeStats[ which(BeeStats$Site=='Dewing'), ]
#choosing color pallet
colors <- c("steelblue", "grey30")
plot1 <- ggplot(data=BeeDew, aes(x=variable, y=logValue, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Bee Morphotype", y = "Observations") + ggtitle('Dewing')
BeeStats <- ddply(Bees, c("Site","Flower"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
'Apis' = sum(Apis, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE),
'Flies' = sum(Flies, na.rm = TRUE))
BeeStats
library(reshape2)
BeeStats <- melt(BeeStats, id.vars = c("Site", "Flower"))
BeeStats$logValue <- log10(BeeStats$value + 1)
# Figure for bees at Borderview:
BeeBV <- BeeStats[ which(BeeStats$Site=='Borderview'), ]
#choosing color pallet
colors <- c("steelblue", "grey30")
#choosing color pallet
colors <- c("steelblue", "grey30")
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=logValue, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Morphotype", y = "Log10(Observations)") + ggtitle('Borderview')
plot1 <- ggplot(data=BeeDew, aes(x=variable, y=logValue, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Morphotype", y = "Log10(Observations)") + ggtitle('Dewing')
# Figure for bees at Dewing:
BeeDew <- BeeStats[ which(BeeStats$Site=='Dewing'), ]
#choosing color pallet
colors <- c("steelblue", "grey30")
plot1 <- ggplot(data=BeeDew, aes(x=variable, y=logValue, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Morphotype", y = "Log10(Observations)") + ggtitle('Dewing')
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=logValue, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Morphotype", y = "Log10(Observations)") + ggtitle('Borderview') + + ylim(0, 3)
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=logValue, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Morphotype", y = "Log10(Observations)") + ggtitle('Borderview') + ylim(0, 3)
plot1 <- ggplot(data=BeeDew, aes(x=variable, y=logValue, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Morphotype", y = "Log10(Observations)") + ggtitle('Dewing') + ylim(0, 3)
BeeStats <- ddply(Bees, c("Site","Flower"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE),
'Flies' = sum(Flies, na.rm = TRUE),
'Apis' = sum(Apis, na.rm = TRUE))
BeeStats
library(reshape2)
BeeStats <- melt(BeeStats, id.vars = c("Site", "Flower"))
BeeStats$logValue <- log10(BeeStats$value + 1)
# Figure for bees at Borderview:
BeeBV <- BeeStats[ which(BeeStats$Site=='Borderview'), ]
#choosing color pallet
colors <- c("steelblue", "grey30")
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=logValue, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Morphotype", y = "Log10(Observations)") + ggtitle('Borderview') + ylim(0, 3)
# Figure for bees at Dewing:
BeeDew <- BeeStats[ which(BeeStats$Site=='Dewing'), ]
#choosing color pallet
colors <- c("steelblue", "grey30")
plot1 <- ggplot(data=BeeDew, aes(x=variable, y=logValue, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Morphotype", y = "Log10(Observations)") + ggtitle('Dewing') + ylim(0, 3)
BeeStats <- ddply(Bees, c("Site","Flower"), summarise,
'Bombus-queen' = sum(BigBombus, BigOrange, na.rm = TRUE),
'Bombus-worker' = sum(SmallBombus, SmallOrange, na.rm = TRUE),
'Black-big' = sum(BigBlack, na.rm = TRUE),
'Black-slender' = sum(SmallBlack, na.rm = TRUE),
'Black-tiny' = sum(TinyBlack, na.rm = TRUE),
'Green' = sum(Green, na.rm = TRUE),
'Apis' = sum(Apis, na.rm = TRUE),
'Flies' = sum(Flies, na.rm = TRUE))
BeeStats
library(reshape2)
BeeStats <- melt(BeeStats, id.vars = c("Site", "Flower"))
BeeStats$logValue <- log10(BeeStats$value + 1)
# Figure for bees at Borderview:
BeeBV <- BeeStats[ which(BeeStats$Site=='Borderview'), ]
#choosing color pallet
colors <- c("steelblue", "grey30")
plot1 <- ggplot(data=BeeBV, aes(x=variable, y=logValue, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Morphotype", y = "Log10(Observations)") + ggtitle('Borderview') + ylim(0, 3)
# Figure for bees at Dewing:
BeeDew <- BeeStats[ which(BeeStats$Site=='Dewing'), ]
#choosing color pallet
colors <- c("steelblue", "grey30")
plot1 <- ggplot(data=BeeDew, aes(x=variable, y=logValue, fill = Flower)) + geom_bar(stat = 'identity', position = 'dodge')
plot1 + theme_bw(base_size = 21) + scale_fill_manual(values=colors) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Morphotype", y = "Log10(Observations)") + ggtitle('Dewing') + ylim(0, 3)
